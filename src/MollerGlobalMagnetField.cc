
//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......

#include "MollerGlobalMagnetField.hh"
#include "TGraph.h"

using namespace CLHEP;

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......

MollerGlobalMagnetField::MollerGlobalMagnetField()
{

  G4cout << G4endl << "###### Calling MollerGlobalMagnetField::MollerGlobalMagnetField() " << G4endl << G4endl;

  fMagneticField_MainMagnet = NULL;
  fMagneticField_MiniMagnet = NULL;

  fieldMessenger = new MollerGlobalMagnetFieldMessenger(this);
  //=======================================================
  //    configuration values of the QTOR field map
  //=======================================================

  BFieldScalingFactor_MainMagnet =   0.0;    // according to Juliette Mammei
  fMagneticField_MainMagnet = new MollerMagnetFieldMap();


  if(fMagneticField_MainMagnet){
    BFieldScalingFactor_MainMagnet = 0.0;
    fMagneticField_MainMagnet->SetFieldMap_RMin(0.015*m);
    fMagneticField_MainMagnet->SetFieldMap_RMax(0.375*m);
    fMagneticField_MainMagnet->SetFieldMap_RStepsize(0.002*m);

    fMagneticField_MainMagnet->SetFieldMap_ZMin(9.5*m);
    fMagneticField_MainMagnet->SetFieldMap_ZMax(17.0*m);
    fMagneticField_MainMagnet->SetFieldMap_ZStepsize(0.1*m);

    fMagneticField_MainMagnet->SetFieldMap_PhiMin(-25*degree);
    fMagneticField_MainMagnet->SetFieldMap_PhiMax(25*degree);
    fMagneticField_MainMagnet->SetFieldMap_PhiStepsize(1*degree);

    fMagneticField_MainMagnet->InitializeGrid();

  }

  //=======================================================
  //    configuration values of the MiniTorus field map
  //=======================================================

  BFieldScalingFactor_MiniMagnet =  0.0;
  fMagneticField_MiniMagnet = new MollerMagnetFieldMap();

  if(fMagneticField_MiniMagnet){
    // 100% of maxiumum current density (560 A/cm^2)
    BFieldScalingFactor_MiniMagnet =  0.0; // according to Juliette Mammei: 84% (470 A/cm^2)

    fMagneticField_MiniMagnet->SetFieldMap_RMin(0.015*m);
    fMagneticField_MiniMagnet->SetFieldMap_RMax(0.375*m);
    fMagneticField_MiniMagnet->SetFieldMap_RStepsize(0.002*m);

    fMagneticField_MiniMagnet->SetFieldMap_ZMin(6.0*m);
    fMagneticField_MiniMagnet->SetFieldMap_ZMax(8.0*m);
    fMagneticField_MiniMagnet->SetFieldMap_ZStepsize(0.1*m);

    fMagneticField_MiniMagnet->SetFieldMap_PhiMin(-25*degree);
    fMagneticField_MiniMagnet->SetFieldMap_PhiMax(25*degree);
    fMagneticField_MiniMagnet->SetFieldMap_PhiStepsize(1*degree);

    fMagneticField_MiniMagnet->InitializeGrid();

  }
  configuration = "crex";
  addQ1fringe=false;

  G4cout << G4endl
         << "Magnetic Shielding low limit= " << mg_field_low
         << "   Magnetic Shielding high limit= " << mg_field_high << G4endl;
  G4cout << G4endl << "###### Leaving MollerGlobalMagnetField::MollerGlobalMagnetField " << G4endl << G4endl;
}

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......
MollerGlobalMagnetField::~MollerGlobalMagnetField()
{
  G4cout << G4endl << "###### Calling MollerGlobalMagnetField::~MollerGlobalMagnetField() " << G4endl << G4endl;
  if (fMagneticField_MainMagnet) delete fMagneticField_MainMagnet;
  if (fMagneticField_MiniMagnet) delete fMagneticField_MiniMagnet;
  delete fieldMessenger;
  G4cout << G4endl << "###### Leaving MollerGlobalMagnetField::~MollerGlobalMagnetField() " << G4endl << G4endl;
}

void MollerGlobalMagnetField::SetConfiguration(const G4String val){
  configuration = val;

  if( val == "prex1" ){
    magScaleFactor = 1.;
    mg_field_low = -44*cm;
    mg_field_high = 44*cm;
  }else if( val == "happex2" ){
    magScaleFactor = 3.;
    mg_field_low = -44*cm;
    mg_field_high = 44*cm;
  }else if( val == "prex2" ){
    magScaleFactor = 1.;
    mg_field_low = -74*cm;
    mg_field_high = 74*cm;
    zPosition = {-200., -199., -198., -197., -196., -195., -194., -193., -192., -191., -190., -189., -188., -187., -186., -185., -184., -183., -182., -181., -180., -179., -178., -177., -176., -175., -174., -173., -172., -171., -170., -169., -168., -167., -166., -165., -164., -163., -162., -161., -160., -159., -158., -157., -156., -155., -154., -153., -152., -151., -150., -149., -148., -147., -146., -145., -144., -143., -142., -141., -140., -139., -138., -137., -136., -135., -134., -133., -132., -131., -130., -129., -128., -127., -126., -125., -124., -123., -122., -121., -120., -119., -118., -117., -116., -115., -114., -113., -112., -111., -110., -109., -108., -107., -106., -105., -104., -103., -102., -101., -100., -99.0, -98.0, -97.0, -96.0, -95.0, -94.0, -93.0, -92.0, -91.0, -90.0, -89.0, -88.0, -87.0, -86.0, -85.0, -84.0, -83.0, -82.0, -81.0, -80.0, -79.0, -78.0, -77.0, -76.0, -75.0, -74.0, -73.0, -72.0, -71.0, -70.0, -69.0, -68.0, -67.0, -66.0, -65.0, -64.0, -63.0, -62.0, -61.0, -60.0, -59.0, -58.0, -57.0, -56.0, -55.0, -54.0, -53.0, -52.0, -51.0, -50.0, -49.0, -48.0, -47.0, -46.0, -45.0, -44.0, -43.0, -42.0, -41.0, -40.0, -39.0, -38.0, -37.0, -36.0, -35.0, -34.0, -33.0, -32.0, -31.0, -30.0, -29.0, -28.0, -27.0, -26.0, -25.0, -24.0, -23.0, -22.0, -21.0, -20.0, -19.0, -18.0, -17.0, -16.0, -15.0, -14.0, -13.0, -12.0, -11.0, -10.0, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00,  0.00,  1.00,  2.00,  3.00,  4.00,  5.00,  6.00,  7.00,  8.00,  9.00,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0,  26.0,  27.0,  28.0,  29.0,  30.0,  31.0,  32.0,  33.0,  34.0,  35.0,  36.0,  37.0,  38.0,  39.0,  40.0,  41.0,  42.0,  43.0,  44.0,  45.0,  46.0,  47.0,  48.0,  49.0,  50.0,  51.0,  52.0,  53.0,  54.0,  55.0,  56.0,  57.0,  58.0,  59.0,  60.0,  61.0,  62.0,  63.0,  64.0,  65.0,  66.0,  67.0,  68.0,  69.0,  70.0,  71.0,  72.0,  73.0,  74.0,  75.0,  76.0,  77.0,  78.0,  79.0,  80.0,  81.0,  82.0,  83.0,  84.0,  85.0,  86.0,  87.0,  88.0,  89.0,  90.0,  91.0,  92.0,  93.0,  94.0,  95.0,  96.0,  97.0,  98.0,  99.0,  100.,  101.,  102.,  103.,  104.,  105.,  106.,  107.,  108.,  109.,  110.,  111.,  112.,  113.,  114.,  115.,  116.,  117.,  118.,  119.,  120.,  121.,  122.,  123.,  124.,  125.,  126.,  127.,  128.,  129.,  130.,  131.,  132.,  133.,  134.,  135.,  136.,  137.,  138.,  139.,  140.,  141.,  142.,  143.,  144.,  145.,  146.,  147.,  148.,  149.,  150.,  151.,  152.,  153.,  154.,  155.,  156.,  157.,  158.,  159.,  160.,  161.,  162.,  163.,  164.,  165.,  166.,  167.,  168.,  169.,  170.,  171.,  172.,  173.,  174.,  175.,  176.,  177.,  178.,  179.,  180.,  181.,  182.,  183.,  184.,  185.,  186.,  187.,  188.,  189.,  190.,  191.,  192.,  193.,  194.,  195.,  196.,  197.,  198.,  199.,  200.};
    bXcomponent = {0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.373759538919E-02, 0.497510494111E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.891221158944E-02, 0.940837381467E-02, 0.195475101044E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.239639798991E-01, 0.154012524871E-01, 0.199143501938E-01, 0.244274479005E-01, 0.289405456072E-01, 0.334536433139E-01, 0.379667410206E-01, 0.424798387273E-01, 0.469929364340E-01, 0.515060341408E-01, 0.560191318475E-01, 0.605322295542E-01, 0.654315322881E-01, 0.724560179269E-01, 0.807790238813E-01, 0.891020298356E-01, 0.974250357899E-01, 0.105748041744    , 0.114071047699    , 0.122394053653    , 0.130717059607    , 0.139040065562    , 0.147363071516    , 0.155686077470    , 0.154159284991    , 0.108709718676    , 0.110052787173    , 0.126722993409    , 0.143393199645    , 0.160063405881    , 0.176733612116    , 0.193403818352    , 0.210074024588    , 0.230475958532    , 0.262005245648    , 0.295089915681    , 0.328174585714    , 0.310988787200    , 0.340988032582    , 0.357468563968    , 0.385939245288    , 0.407112854965    , 0.447762135417    , 0.485585472051    , 0.521112933015    , 0.572364277328    , 0.610215555439    , 0.648375775009    , 0.706745338812    , 0.770776577554    , 0.833262983829    , 0.792094977334    , 0.937032681151    ,  1.03632261805    ,  1.11437040149    ,  1.19086552157    ,  1.29599036388    ,  1.48258214453    ,  1.62079650622    ,  1.71929958076    ,  1.83851345063    ,  2.00724204987    ,  2.34587803161    ,  2.46281814571    ,  2.72821906195    ,  2.71078924318    ,  3.00049218737    ,  3.40335562391    ,  3.61220993556    ,  4.10777528272    ,  4.41626249783    ,  5.11190557198    ,  5.18535758715    ,  5.74124928949    ,  6.06144297711    ,  6.36637395834    ,  6.21793297659    ,  6.04933080560    ,  6.03685325919    ,  5.43607818156    ,  4.29768140345    ,  3.14189873477    ,  1.76882029069    ,  1.17041315276    , 0.621573945016    , 0.334712763752    , 0.220806245894    , 0.181761563244    , 0.170806951493    , 0.149874893352    , 0.130538520016    , 0.949301950256E-01, 0.533007487183E-01, 0.348198063650E-01, 0.345444183408E-01, 0.671836409740E-01, 0.118970262377    , 0.183580744854    , 0.272387104547    , 0.382700499695    , 0.509711308466    , 0.570948264811    , 0.630061787313    , 0.664963432021    , 0.606999689407    , 0.504139158343    , 0.325316011084    , 0.111078398905    , 0.454147659210E-01, 0.299860522636E-01, 0.251424579679E-01, 0.258996629884E-01, 0.242197772463E-01, 0.247031989023E-01, 0.276902553737E-01, 0.277547009648E-01, 0.279249956822E-01, 0.292211771761E-01, 0.309787232057E-01, 0.313035099849E-01, 0.315935409045E-01, 0.386156712637E-01, 0.378163731366E-01, 0.395254996198E-01, 0.369093577331E-01, 0.389391054382E-01, 0.405983043628E-01, 0.402674226577E-01, 0.360175309858E-01, 0.354427563641E-01, 0.356814161502E-01, 0.416280472842E-01, 0.420212827763E-01, 0.427284684687E-01, 0.448669133314E-01, 0.385662841851E-01, 0.361268691277E-01, 0.360074353226E-01, 0.409409221003E-01, 0.367739061894E-01, 0.381603228748E-01, 0.386840119199E-01, 0.385259171598E-01, 0.370683153505E-01, 0.369447262446E-01, 0.371300500222E-01, 0.381647130827E-01, 0.425371287590E-01, 0.422733497630E-01, 0.370057368010E-01, 0.423416649110E-01, 0.415305453334E-01, 0.425267231334E-01, 0.431205568593E-01, 0.420754362766E-01, 0.381727530482E-01, 0.400752291503E-01, 0.412184923462E-01, 0.402703170627E-01, 0.399332897869E-01, 0.403672132766E-01, 0.431118835236E-01, 0.442190177916E-01, 0.478760219748E-01, 0.543953132624E-01, 0.571654350075E-01, 0.624507053486E-01, 0.803500280449E-01, 0.761911035711E-01, 0.740148475245E-01, 0.801780983998E-01, 0.839079275599E-01, 0.859131717515E-01, 0.863061009774E-01, 0.827746647972E-01, 0.801092702120E-01, 0.879196601607E-01, 0.784572297816E-01, 0.776413896034E-01, 0.784961089876E-01, 0.710691070844E-01, 0.724689552446E-01, 0.800758262417E-01, 0.733708557820E-01, 0.627326368193E-01, 0.635964256210E-01, 0.532618382828E-01, 0.506944959369E-01, 0.457023760407E-01, 0.426344760135E-01, 0.427290219393E-01, 0.423241080252E-01, 0.468554906356E-01, 0.431126318819E-01, 0.436211686446E-01, 0.499303271581E-01, 0.442554149970E-01, 0.424910104330E-01, 0.441219576241E-01, 0.510007982004E-01, 0.914933168133E-01, 0.232813407647    , 0.591955036409    ,  1.37595530557    ,  2.17786255269    ,  2.93954343801    ,  3.46720745585    ,  3.58258633831    ,  3.48386129032    ,  3.46289647990    ,  3.74972786319    ,  3.47317678307    ,  3.32375728656    ,  3.15338443487    ,  3.02003741135    ,  3.16619619035    ,  3.12130453409    ,  3.10445410597    ,  3.29619083177    ,  3.45177683752    ,  3.68696002976    ,  3.76715445963    ,  3.56005980073    ,  3.76759462878    ,  4.08768524461    ,  4.06920847327    ,  4.12911380607    ,  3.91601430231    ,  3.67109845503    ,  3.52603182099    ,  3.28086029884    ,  3.19765470559    ,  2.94096179381    ,  3.01210344001    ,  2.69404581603    ,  2.44347265214    ,  2.44970923427    ,  2.21756639308    ,  2.09191662439    ,  1.86404020626    ,  1.63590430649    ,  1.45364355725    ,  1.34980325137    ,  1.38926943449    ,  1.27679187017    ,  1.22874638264    ,  1.07265930162    , 0.970945640419    , 0.982768609781    , 0.798645604157    , 0.722267187164    , 0.679552860689    , 0.636511837448    , 0.607670869436    , 0.505116482940    , 0.492959812864    , 0.484898266625    , 0.422504635849    , 0.427103704453    , 0.369450881608    , 0.349653690681    , 0.330599232955    , 0.291362508446    , 0.267648392354    , 0.261704388959    , 0.250171514341    , 0.242762943395    , 0.209413501063    , 0.193679627347    , 0.188345956877    , 0.185503342786    , 0.168744255316    , 0.154579765931    , 0.149703371712    , 0.138488987553    , 0.136991161901    , 0.129740571383    , 0.118969804984    , 0.111402486053    , 0.114860700679    , 0.103016469606    , 0.953272995903E-01, 0.842115556336E-01, 0.793637785612E-01, 0.791994271870E-01, 0.748036355636E-01, 0.683368279073E-01, 0.649307012788E-01, 0.559896594420E-01, 0.516421079340E-01, 0.507003134169E-01, 0.506502733435E-01, 0.477301186962E-01, 0.457271875386E-01, 0.427508137662E-01, 0.423262222931E-01, 0.402778984923E-01, 0.376293285859E-01, 0.371742346631E-01, 0.346389907705E-01, 0.305315559414E-01, 0.301219279027E-01, 0.297933026740E-01, 0.291045974007E-01, 0.259869986600E-01, 0.244453327230E-01, 0.230467448756E-01, 0.241308559943E-01, 0.236060884808E-01, 0.202554659185E-01, 0.189670124549E-01, 0.185052390626E-01, 0.179824935700E-01, 0.186776374091E-01, 0.161075731846E-01, 0.159521543617E-01, 0.143628315748E-01, 0.140392308388E-01, 0.136359828821E-01, 0.128089724357E-01, 0.119699363225E-01, 0.121231649936E-01, 0.103622168065E-01, 0.107904915148E-01, 0.112167344339E-01, 0.100303912304E-01, 0.864763919368E-02, 0.902325132826E-02, 0.902131899718E-02, 0.846901931103E-02, 0.823753507611E-02, 0.752420857354E-02, 0.697181218230E-02, 0.644369644272E-02, 0.662341611034E-02, 0.667685637988E-02, 0.623650122610E-02, 0.608292920134E-02, 0.609384943443E-02, 0.558177248356E-02, 0.560398093192E-02, 0.530595086991E-02, 0.478382407788E-02, 0.487517112778E-02, 0.482286789262E-02, 0.464960973288E-02, 0.422783350054E-02, 0.416451565159E-02, 0.382205584018E-02, 0.366027129415E-02, 0.333825386098E-02};
  }else if( val == "crex" ){
    magScaleFactor = 0.219;
    mg_field_low = -74*cm;
    mg_field_high = 74*cm;
    zPosition = {-200., -199., -198., -197., -196., -195., -194., -193., -192., -191., -190., -189., -188., -187., -186., -185., -184., -183., -182., -181., -180., -179., -178., -177., -176., -175., -174., -173., -172., -171., -170., -169., -168., -167., -166., -165., -164., -163., -162., -161., -160., -159., -158., -157., -156., -155., -154., -153., -152., -151., -150., -149., -148., -147., -146., -145., -144., -143., -142., -141., -140., -139., -138., -137., -136., -135., -134., -133., -132., -131., -130., -129., -128., -127., -126., -125., -124., -123., -122., -121., -120., -119., -118., -117., -116., -115., -114., -113., -112., -111., -110., -109., -108., -107., -106., -105., -104., -103., -102., -101., -100., -99.0, -98.0, -97.0, -96.0, -95.0, -94.0, -93.0, -92.0, -91.0, -90.0, -89.0, -88.0, -87.0, -86.0, -85.0, -84.0, -83.0, -82.0, -81.0, -80.0, -79.0, -78.0, -77.0, -76.0, -75.0, -74.0, -73.0, -72.0, -71.0, -70.0, -69.0, -68.0, -67.0, -66.0, -65.0, -64.0, -63.0, -62.0, -61.0, -60.0, -59.0, -58.0, -57.0, -56.0, -55.0, -54.0, -53.0, -52.0, -51.0, -50.0, -49.0, -48.0, -47.0, -46.0, -45.0, -44.0, -43.0, -42.0, -41.0, -40.0, -39.0, -38.0, -37.0, -36.0, -35.0, -34.0, -33.0, -32.0, -31.0, -30.0, -29.0, -28.0, -27.0, -26.0, -25.0, -24.0, -23.0, -22.0, -21.0, -20.0, -19.0, -18.0, -17.0, -16.0, -15.0, -14.0, -13.0, -12.0, -11.0, -10.0, -9.00, -8.00, -7.00, -6.00, -5.00, -4.00, -3.00, -2.00, -1.00,  0.00,  1.00,  2.00,  3.00,  4.00,  5.00,  6.00,  7.00,  8.00,  9.00,  10.0,  11.0,  12.0,  13.0,  14.0,  15.0,  16.0,  17.0,  18.0,  19.0,  20.0,  21.0,  22.0,  23.0,  24.0,  25.0,  26.0,  27.0,  28.0,  29.0,  30.0,  31.0,  32.0,  33.0,  34.0,  35.0,  36.0,  37.0,  38.0,  39.0,  40.0,  41.0,  42.0,  43.0,  44.0,  45.0,  46.0,  47.0,  48.0,  49.0,  50.0,  51.0,  52.0,  53.0,  54.0,  55.0,  56.0,  57.0,  58.0,  59.0,  60.0,  61.0,  62.0,  63.0,  64.0,  65.0,  66.0,  67.0,  68.0,  69.0,  70.0,  71.0,  72.0,  73.0,  74.0,  75.0,  76.0,  77.0,  78.0,  79.0,  80.0,  81.0,  82.0,  83.0,  84.0,  85.0,  86.0,  87.0,  88.0,  89.0,  90.0,  91.0,  92.0,  93.0,  94.0,  95.0,  96.0,  97.0,  98.0,  99.0,  100.,  101.,  102.,  103.,  104.,  105.,  106.,  107.,  108.,  109.,  110.,  111.,  112.,  113.,  114.,  115.,  116.,  117.,  118.,  119.,  120.,  121.,  122.,  123.,  124.,  125.,  126.,  127.,  128.,  129.,  130.,  131.,  132.,  133.,  134.,  135.,  136.,  137.,  138.,  139.,  140.,  141.,  142.,  143.,  144.,  145.,  146.,  147.,  148.,  149.,  150.,  151.,  152.,  153.,  154.,  155.,  156.,  157.,  158.,  159.,  160.,  161.,  162.,  163.,  164.,  165.,  166.,  167.,  168.,  169.,  170.,  171.,  172.,  173.,  174.,  175.,  176.,  177.,  178.,  179.,  180.,  181.,  182.,  183.,  184.,  185.,  186.,  187.,  188.,  189.,  190.,  191.,  192.,  193.,  194.,  195.,  196.,  197.,  198.,  199.,  200.};
    bXcomponent = {0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.818281859655E-02, 0.110335141326E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.201029328936E-01, 0.212831567667E-01, 0.454011772312E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.559066587481E-01, 0.350350878440E-01, 0.459326387685E-01, 0.568301896930E-01, 0.677277406175E-01, 0.786252915421E-01, 0.895228424666E-01, 0.100420393391    , 0.111317944316    , 0.122215495240    , 0.133113046165    , 0.144010597089    , 0.155845967364    , 0.172839472452    , 0.192987155704    , 0.213134838957    , 0.233282522209    , 0.253430205462    , 0.273577888714    , 0.293725571967    , 0.313873255219    , 0.334020938472    , 0.354168621724    , 0.374316304977    , 0.370545452630    , 0.260127332302    , 0.263373029140    , 0.303840677736    , 0.344308326331    , 0.384775974927    , 0.425243623523    , 0.465711272119    , 0.506178920714    , 0.555734111417    , 0.632353328250    , 0.712746841817    , 0.793140355385    , 0.751581390537    , 0.824576237002    , 0.864787467528    , 0.934142570580    , 0.985852833906    ,  1.08484060208    ,  1.17705546685    ,  1.26375072940    ,  1.38867525401    ,  1.48117326117    ,  1.57456148894    ,  1.71703212541    ,  1.87336493579    ,  2.02604342487    ,  1.92672897042    ,  2.28024231160    ,  2.52287087603    ,  2.71386428202    ,  2.90132219957    ,  3.15874713007    ,  3.61487777885    ,  3.95314308926    ,  4.19500632472    ,  4.48746783529    ,  4.90094212999    ,  5.72946326609    ,  6.01681090603    ,  6.66728995306    ,  6.62666766586    ,  7.33709664098    ,  8.32452981263    ,  8.83743888541    ,  10.0524214497    ,  10.8097151360    ,  12.5154187186    ,  12.6984989659    ,  14.0626759214    ,  14.8497876575    ,  15.5995659278    ,  15.2383726140    ,  14.8276543334    ,  14.7994091035    ,  13.3290470453    ,  10.5402300822    ,  7.70856489095    ,  4.34408136711    ,  2.87926323324    ,  1.53513140030    , 0.833067237731    , 0.556568969749    , 0.464877809886    , 0.441237821584    , 0.388704460872    , 0.339318914667    , 0.250128588550    , 0.147162683263    , 0.105023249522    , 0.109439776052    , 0.199785325754    , 0.347757220022    , 0.533507943766    , 0.792802100070    ,  1.12502721116    ,  1.52076247135    ,  1.73617403880    ,  1.97543834295    ,  2.16818368865    ,  2.06702768361    ,  1.78463395771    ,  1.19619974836    , 0.460685980896    , 0.256653092295    , 0.223930027188    , 0.238290241196    , 0.305492284201    , 0.336019818088    , 0.405164462597    , 0.523986565844    , 0.601763542213    , 0.698969288362    , 0.810911669736    , 0.951110231995    ,  1.04152764460    ,  1.12120206368    ,  1.43897446732    ,  1.46485728402    ,  1.58401412751    ,  1.53125481713    ,  1.67340092767    ,  1.79683560522    ,  1.81591768471    ,  1.63552216531    ,  1.61287570283    ,  1.61119820414    ,  1.86841517935    ,  1.88553345243    ,  1.94656821293    ,  2.10812315024    ,  1.88199122191    ,  1.81538819879    ,  1.82957675842    ,  2.08645671424    ,  1.87839402988    ,  1.95826276248    ,  1.99632988715    ,  2.00058209021    ,  1.94210469675    ,  1.95387826451    ,  1.97222995973    ,  2.00515374303    ,  2.16645631728    ,  2.08929145218    ,  1.79077469528    ,  2.02908219172    ,  1.99305464546    ,  2.04592565806    ,  2.07648565613    ,  2.02746243558    ,  1.84141316041    ,  1.93712234253    ,  2.00493334217    ,  1.98119556383    ,  2.00334869171    ,  2.05338962049    ,  2.22577663349    ,  2.31289022640    ,  2.53126941676    ,  2.92075105741    ,  3.14265739222    ,  3.54663686285    ,  4.65644049226    ,  4.50851531900    ,  4.41731763361    ,  4.77296508825    ,  4.91874656635    ,  4.93749984216    ,  4.83837983724    ,  4.51641482565    ,  4.21399921383    ,  4.44745392364    ,  3.82036193380    ,  3.57306073499    ,  3.37100769616    ,  2.83340668515    ,  2.57752779136    ,  2.54870556479    ,  2.09888379549    ,  1.62390743618    ,  1.48974846748    ,  1.09370636426    , 0.899502677059    , 0.695979560467    , 0.535540212905    , 0.441899582153    , 0.344382424264    , 0.310414640380    , 0.239529217012    , 0.207338706066    , 0.205997849384    , 0.166568262928    , 0.149747429245    , 0.148609101457    , 0.167974053476    , 0.298756240958    , 0.763091859190    ,  1.95208792340    ,  4.54432359579    ,  7.13654240170    ,  9.56639189352    ,  11.1832736808    ,  11.4438685181    ,  11.0259404078    ,  10.8740119958    ,  11.7034334719    ,  10.7982239824    ,  10.3036001242    ,  9.75098099205    ,  9.30864626931    ,  9.72047928382    ,  9.51921061706    ,  9.37715812432    ,  9.80562601565    ,  10.0721501561    ,  10.5510066296    ,  10.5413285489    ,  9.74158363076    ,  10.0712376052    ,  10.7273334348    ,  10.5305990977    ,  10.5763675571    ,  9.93987535049    ,  9.25545766275    ,  8.83534280019    ,  8.19072516691    ,  7.95090178458    ,  7.29147329881    ,  7.45216945652    ,  6.65231492928    ,  6.02426940158    ,  6.03046574812    ,  5.45326289494    ,  5.13894204887    ,  4.57479094725    ,  4.01142639867    ,  3.56144248443    ,  3.30442155967    ,  3.39895327799    ,  3.12169929504    ,  3.00249889190    ,  2.61943692902    ,  2.36963050411    ,  2.39716966500    ,  1.94686499292    ,  1.75952540896    ,  1.65460905733    ,  1.54898555818    ,  1.47806736169    ,  1.22796223194    ,  1.19767840862    ,  1.17751650659    ,  1.02551949569    ,  1.03603547890    , 0.895722950729    , 0.847270887371    , 0.800667093263    , 0.705222948813    , 0.647455485486    , 0.632703581533    , 0.604514964558    , 0.586264926893    , 0.505398877240    , 0.467146015410    , 0.454049170284    , 0.446914348678    , 0.406308996607    , 0.371962386523    , 0.360031751409    , 0.332842930116    , 0.329037723368    , 0.311431519015    , 0.285412837093    , 0.267083018383    , 0.275210492818    , 0.246680505376    , 0.228094246096    , 0.201382717925    , 0.189668521546    , 0.189142877943    , 0.178527903174    , 0.162982625052    , 0.154750004415    , 0.133335755349    , 0.122904054144    , 0.120572944397    , 0.120381394926    , 0.113361074119    , 0.108522738387    , 0.101385252461    , 0.100313117026    , 0.953882872491E-01, 0.890484109991E-01, 0.879028924778E-01, 0.818558311832E-01, 0.720887674039E-01, 0.710708270813E-01, 0.702425895030E-01, 0.685663395006E-01, 0.611762848128E-01, 0.574981241403E-01, 0.541718489560E-01, 0.566729022250E-01, 0.553989732958E-01, 0.474948183227E-01, 0.444453190219E-01, 0.433291380504E-01, 0.420664665453E-01, 0.436589778971E-01, 0.376213201113E-01, 0.372253714966E-01, 0.334900716701E-01, 0.327081311377E-01, 0.317441220908E-01, 0.297951383866E-01, 0.278185479789E-01, 0.281528763490E-01, 0.240441487711E-01, 0.250150256038E-01, 0.259826176981E-01, 0.232143040811E-01, 0.199974545526E-01, 0.208463990532E-01, 0.208241514601E-01, 0.195337591045E-01, 0.189818375812E-01, 0.173234084579E-01, 0.160382968249E-01, 0.148116232880E-01, 0.152102746459E-01, 0.153208033257E-01, 0.142972468873E-01, 0.139312218106E-01, 0.139452094619E-01, 0.127610523499E-01, 0.127996123703E-01, 0.121100294205E-01, 0.109072685606E-01, 0.111059409402E-01, 0.109766811350E-01, 0.105739428930E-01, 0.960506717681E-02, 0.945181979551E-02, 0.866617646180E-02, 0.829183248899E-02, 0.755848842866E-02};
  }else if( val == "prex2_fitFringe" ){
    magScaleFactor = 1.;
    mg_field_low = -74*cm;
    mg_field_high = 74*cm;
  }else if( val == "prex2_prevDefault" ){
    magScaleFactor = 1.;
    mg_field_low = -74*cm;
    mg_field_high = 74*cm;
    zPosition = {-200, -199.5, -199, -198.5, -198, -197.5, -197, -196.5, -196, -195.5, -195, -194.5, -194, -193.5, -193, -192.5, -192, -191.5, -191, -190.5, -190, -189.5, -189, -188.5, -188, -187.5, -187, -186.5, -186, -185.5, -185, -184.5, -184, -183.5, -183, -182.5, -182, -181.5, -181, -180.5, -180, -179.5, -179, -178.5, -178, -177.5, -177, -176.5, -176, -175.5, -175, -174.5, -174, -173.5, -173, -172.5, -172, -171.5, -171, -170.5, -170, -169.5, -169, -168.5, -168, -167.5, -167, -166.5, -166, -165.5, -165, -164.5, -164, -163.5, -163, -162.5, -162, -161.5, -161, -160.5, -160, -159.5, -159, -158.5, -158, -157.5, -157, -156.5, -156, -155.5, -155, -154.5, -154, -153.5, -153, -152.5, -152, -151.5, -151, -150.5, -150, -149.5, -149, -148.5, -148, -147.5, -147, -146.5, -146, -145.5, -145, -144.5, -144, -143.5, -143, -142.5, -142, -141.5, -141, -140.5, -140, -139.5, -139, -138.5, -138, -137.5, -137, -136.5, -136, -135.5, -135, -134.5, -134, -133.5, -133, -132.5, -132, -131.5, -131, -130.5, -130, -129.5, -129, -128.5, -128, -127.5, -127, -126.5, -126, -125.5, -125, -124.5, -124, -123.5, -123, -122.5, -122, -121.5, -121, -120.5, -120, -119.5, -119, -118.5, -118, -117.5, -117, -116.5, -116, -115.5, -115, -114.5, -114, -113.5, -113, -112.5, -112, -111.5, -111, -110.5, -110, -109.5, -109, -108.5, -108, -107.5, -107, -106.5, -106, -105.5, -105, -104.5, -104, -103.5, -103, -102.5, -102, -101.5, -101, -100.5, -100, -99.5, -99, -98.5, -98, -97.5, -97, -96.5, -96, -95.5, -95, -94.5, -94, -93.5, -93, -92.5, -92, -91.5, -91, -90.5, -90, -89.5, -89, -88.5, -88, -87.5, -87, -86.5, -86, -85.5, -85, -84.5, -84, -83.5, -83, -82.5, -82, -81.5, -81, -80.5, -80, -79.5, -79, -78.5, -78, -77.5, -77, -76.5, -76, -75.5, -75, -74.5, -74, -73.5, -73, -72.5, -72, -71.5, -71, -70.5, -70, -69.5, -69, -68.5, -68, -67.5, -67, -66.5, -66, -65.5, -65, -64.5, -64, -63.5, -63, -62.5, -62, -61.5, -61, -60.5, -60, -59.5, -59, -58.5, -58, -57.5, -57, -56.5, -56, -55.5, -55, -54.5, -54, -53.5, -53, -52.5, -52, -51.5, -51, -50.5, -50, -49.5, -49, -48.5, -48, -47.5, -47, -46.5, -46, -45.5, -45, -44.5, -44, -43.5, -43, -42.5, -42, -41.5, -41, -40.5, -40, -39.5, -39, -38.5, -38, -37.5, -37, -36.5, -36, -35.5, -35, -34.5, -34, -33.5, -33, -32.5, -32, -31.5, -31, -30.5, -30, -29.5, -29, -28.5, -28, -27.5, -27, -26.5, -26, -25.5, -25, -24.5, -24, -23.5, -23, -22.5, -22, -21.5, -21, -20.5, -20, -19.5, -19, -18.5, -18, -17.5, -17, -16.5, -16, -15.5, -15, -14.5, -14, -13.5, -13, -12.5, -12, -11.5, -11, -10.5, -10, -9.5, -9, -8.5, -8, -7.5, -7, -6.5, -6, -5.5, -5, -4.5, -4, -3.5, -3, -2.5, -2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6, 6.5, 7, 7.5, 8, 8.5, 9, 9.5, 10, 10.5, 11, 11.5, 12, 12.5, 13, 13.5, 14, 14.5, 15, 15.5, 16, 16.5, 17, 17.5, 18, 18.5, 19, 19.5, 20, 20.5, 21, 21.5, 22, 22.5, 23, 23.5, 24, 24.5, 25, 25.5, 26, 26.5, 27, 27.5, 28, 28.5, 29, 29.5, 30, 30.5, 31, 31.5, 32, 32.5, 33, 33.5, 34, 34.5, 35, 35.5, 36, 36.5, 37, 37.5, 38, 38.5, 39, 39.5, 40, 40.5, 41, 41.5, 42, 42.5, 43, 43.5, 44, 44.5, 45, 45.5, 46, 46.5, 47, 47.5, 48, 48.5, 49, 49.5, 50, 50.5, 51, 51.5, 52, 52.5, 53, 53.5, 54, 54.5, 55, 55.5, 56, 56.5, 57, 57.5, 58, 58.5, 59, 59.5, 60, 60.5, 61, 61.5, 62, 62.5, 63, 63.5, 64, 64.5, 65, 65.5, 66, 66.5, 67, 67.5, 68, 68.5, 69, 69.5, 70, 70.5, 71, 71.5, 72, 72.5, 73, 73.5, 74, 74.5, 75, 75.5, 76, 76.5, 77, 77.5, 78, 78.5, 79, 79.5, 80, 80.5, 81, 81.5, 82, 82.5, 83, 83.5, 84, 84.5, 85, 85.5, 86, 86.5, 87, 87.5, 88, 88.5, 89, 89.5, 90, 90.5, 91, 91.5, 92, 92.5, 93, 93.5, 94, 94.5, 95, 95.5, 96, 96.5, 97, 97.5, 98, 98.5, 99, 99.5, 100, 100.5, 101, 101.5, 102, 102.5, 103, 103.5, 104, 104.5, 105, 105.5, 106, 106.5, 107, 107.5, 108, 108.5, 109, 109.5, 110, 110.5, 111, 111.5, 112, 112.5, 113, 113.5, 114, 114.5, 115, 115.5, 116, 116.5, 117, 117.5, 118, 118.5, 119, 119.5, 120, 120.5, 121, 121.5, 122, 122.5, 123, 123.5, 124, 124.5, 125, 125.5, 126, 126.5, 127, 127.5, 128, 128.5, 129, 129.5, 130, 130.5, 131, 131.5, 132, 132.5, 133, 133.5, 134, 134.5, 135, 135.5, 136, 136.5, 137, 137.5, 138, 138.5, 139, 139.5, 140, 140.5, 141, 141.5, 142, 142.5, 143, 143.5, 144, 144.5, 145, 145.5, 146, 146.5, 147, 147.5, 148, 148.5, 149, 149.5, 150, 150.5, 151, 151.5, 152, 152.5, 153, 153.5, 154, 154.5, 155, 155.5, 156, 156.5, 157, 157.5, 158, 158.5, 159, 159.5, 160, 160.5, 161, 161.5, 162, 162.5, 163, 163.5, 164, 164.5, 165, 165.5, 166, 166.5, 167, 167.5, 168, 168.5, 169, 169.5, 170, 170.5, 171, 171.5, 172, 172.5, 173, 173.5, 174, 174.5, 175, 175.5, 176, 176.5, 177, 177.5, 178, 178.5, 179, 179.5, 180, 180.5, 181, 181.5, 182, 182.5, 183, 183.5, 184, 184.5, 185, 185.5, 186, 186.5, 187, 187.5, 188, 188.5, 189, 189.5, 190, 190.5, 191, 191.5, 192, 192.5, 193, 193.5, 194, 194.5, 195, 195.5, 196, 196.5, 197, 197.5, 198, 198.5, 199, 199.5, 200};
    bXcomponent = {-0.00430807, -0.00434033, -0.00437288, -0.00440573, -0.00443886, -0.00447229, -0.00450602, -0.00454005, -0.00457438, -0.00460903, -0.00464399, -0.00467926, -0.00471486, -0.00475077, -0.00478701, -0.00482358, -0.00486048, -0.00489772, -0.00493529, -0.00497321, -0.00501147, -0.00505009, -0.00508906, -0.00512838, -0.00516807, -0.00520812, -0.00524854, -0.00528933, -0.0053305, -0.00537205, -0.00541399, -0.00545632, -0.00549903, -0.00554215, -0.00558503, -0.00562805, -0.0056734, -0.00572536, -0.00568739, -0.00582419, -0.00587284, -0.00591746, -0.00596254, -0.00600679, -0.00605403, -0.00610222, -0.00615086, -0.00619996, -0.00624953, -0.00629958, -0.00635009, -0.0064011, -0.00645259, -0.00650457, -0.00655706, -0.00661004, -0.00666354, -0.00671755, -0.00677208, -0.00682714, -0.00688274, -0.00693887, -0.00699555, -0.00705278, -0.00711056, -0.00716799, -0.00722854, -0.007288, -0.00734805, -0.00740869, -0.00746993, -0.00753177, -0.00759422, -0.00765729, -0.00772099, -0.00778532, -0.00785029, -0.00791591, -0.00798218, -0.00804912, -0.00811672, -0.008185, -0.00825397, -0.00832363, -0.008394, -0.00846507, -0.00853686, -0.00860938, -0.00868263, -0.00875663, -0.00883137, -0.00890688, -0.00898316, -0.00906022, -0.00917457, -0.00920469, -0.00927722, -0.00927508, -0.009441, -0.00943532, -0.00960808, -0.00969183, -0.00977645, -0.00986194, -0.00994833, -0.0100356, -0.0101238, -0.0102129, -0.0103029, -0.0103939, -0.0104859, -0.0105788, -0.0106726, -0.0107675, -0.0108634, -0.0109603, -0.0110582, -0.0111571, -0.0112571, -0.0113582, -0.0114603, -0.0115635, -0.0116679, -0.0117733, -0.0118799, -0.0119876, -0.0120965, -0.0122065, -0.0123178, -0.0124302, -0.0125438, -0.0126587, -0.0127749, -0.0128923, -0.0130109, -0.0131309, -0.0132522, -0.0133748, -0.0134988, -0.0136241, -0.0137508, -0.0138789, -0.0139842, -0.01413, -0.0142632, -0.0143979, -0.014534, -0.0146715, -0.0148105, -0.014951, -0.015093, -0.0152365, -0.015394, -0.0155393, -0.0156863, -0.0158351, -0.0159857, -0.0161381, -0.0162923, -0.0164483, -0.0166061, -0.0167658, -0.0169273, -0.0170908, -0.0172563, -0.0174236, -0.0175928, -0.0177641, -0.0179376, -0.0181128, -0.0182901, -0.0184694, -0.0186513, -0.0188342, -0.01902, -0.019208, -0.0193981, -0.0195881, -0.0197841, -0.0199811, -0.0201804, -0.020382, -0.0205859, -0.0207924, -0.0210012, -0.0212126, -0.0214265, -0.0216429, -0.0218619, -0.0220835, -0.0223078, -0.0225347, -0.0227644, -0.0229968, -0.023232, -0.0234701, -0.0237111, -0.0239549, -0.0242017, -0.0244516, -0.0247044, -0.0249604, -0.0252194, -0.0254817, -0.0257471, -0.0260158, -0.0262878, -0.0265723, -0.0268434, -0.0271255, -0.0274111, -0.0277003, -0.0279931, -0.0282895, -0.0285896, -0.0288935, -0.0292012, -0.0295127, -0.0298282, -0.0301476, -0.0304711, -0.0307986, -0.0311303, -0.0314662, -0.0318063, -0.0321508, -0.0324997, -0.032853, -0.0332108, -0.0335732, -0.0339403, -0.0343121, -0.0346887, -0.0350701, -0.0354565, -0.0358478, -0.0362442, -0.0366458, -0.0370526, -0.0374647, -0.0378822, -0.0383051, -0.0387336, -0.0391677, -0.0396075, -0.0400531, -0.0405046, -0.040962, -0.0414255, -0.0418951, -0.042371, -0.0428532, -0.0433418, -0.043837, -0.0443387, -0.0448472, -0.0453625, -0.0458848, -0.046414, -0.0469504, -0.0474941, -0.0480451, -0.0486036, -0.0491696, -0.0497434, -0.050325, -0.0509145, -0.0515121, -0.0521178, -0.0527319, -0.0533544, -0.0539855, -0.0546252, -0.0552738, -0.0559314, -0.0565981, -0.057274, -0.0579594, -0.0586543, -0.0593588, -0.0600732, -0.0607976, -0.0615322, -0.0622771, -0.0630324, -0.0637984, -0.0645752, -0.065363, -0.0661619, -0.0669721, -0.0677939, -0.0686273, -0.0694726, -0.0703299, -0.0711995, -0.0720816, -0.0729763, -0.0738838, -0.0748044, -0.0757383, -0.0766856, -0.0776465, -0.0786214, -0.0796104, -0.0806138, -0.0816317, -0.0826645, -0.0837123, -0.0847754, -0.085854, -0.0869484, -0.0880589, -0.0891857, -0.090329, -0.0914891, -0.0926666, -0.0938611, -0.0950957, -0.0963004, -0.0975486, -0.0988155, -0.100101, -0.101406, -0.10273, -0.104074, -0.105438, -0.106822, -0.108227, -0.109654, -0.111101, -0.11257, -0.114062, -0.115576, -0.117112, -0.118672, -0.120256, -0.121863, -0.123495, -0.125151, -0.126833, -0.12854, -0.130273, -0.132033, -0.13382, -0.135632, -0.137473, -0.139342, -0.141239, -0.143153, -0.145127, -0.14712, -0.14913, -0.15118, -0.153259, -0.155371, -0.157515, -0.159694, -0.1619, -0.164145, -0.166424, -0.168736, -0.171087, -0.173473, -0.175896, -0.178356, -0.180855, -0.183399, -0.185968, -0.188584, -0.19124, -0.193938, -0.196681, -0.199875, -0.202279, -0.205146, -0.208058, -0.211014, -0.214017, -0.217065, -0.22016, -0.223303, -0.226156, -0.228827, -0.233025, -0.236366, -0.239759, -0.243203, -0.2467, -0.250251, -0.253856, -0.257516, -0.261232, -0.265004, -0.268834, -0.272722, -0.276669, -0.280675, -0.284742, -0.288871, -0.293061, -0.297314, -0.301631, -0.306012, -0.310458, -0.314971, -0.31955, -0.324197, -0.328912, -0.333697, -0.338551, -0.343476, -0.348472, -0.353541, -0.358682, -0.363897, -0.369186, -0.374551, -0.379991, -0.385508, -0.391101, -0.396772, -0.402522, -0.40835, -0.414258, -0.420246, -0.426314, -0.432464, -0.438693, -0.445002, -0.451395, -0.457866, -0.464426, -0.472291, -0.477785, -0.484595, -0.492415, -0.498864, -0.505515, -0.513149, -0.520132, -0.527192, -0.534584, -0.542059, -0.549205, -0.55688, -0.564594, -0.57245, -0.580746, -0.588702, -0.59675, -0.604508, -0.612649, -0.620863, -0.629192, -0.637603, -0.645863, -0.654533, -0.663513, -0.672234, -0.679987, -0.688756, -0.697703, -0.706613, -0.715505, -0.724515, -0.733552, -0.742587, -0.751717, -0.760862, -0.770056, -0.779256, -0.788475, -0.797715, -0.806965, -0.816221, -0.825481, -0.834736, -0.843983, -0.853214, -0.862426, -0.871612, -0.880762, -0.889883, -0.898987, -0.908044, -0.916817, -0.925819, -0.934597, -0.943385, -0.952039, -0.960347, -0.969057, -0.977197, -0.985404, -0.993763, -1.00109, -1.00899, -1.01731, -1.02475, -1.03214, -1.03941, -1.04648, -1.05333, -1.05879, -1.06526, -1.07295, -1.07919, -1.08522, -1.091, -1.0966, -1.102, -1.10722, -1.11125, -1.11609, -1.12072, -1.12526, -1.1311, -1.13532, -1.13939, -1.14476, -1.14863, -1.15367, -1.15712, -1.16119, -1.16394, -1.16762, -1.17133, -1.17568, -1.17906, -1.18309, -1.18811, -1.19114, -1.19506, -1.19982, -1.20573, -1.21276, -1.21511, -1.22155, -1.22806, -1.23559, -1.2438, -1.25609, -1.26549, -1.27557, -1.28751, -1.29746, -1.30933, -1.32235, -1.33639, -1.34699, -1.36114, -1.37597, -1.39085, -1.4064, -1.41968, -1.43307, -1.4453, -1.45602, -1.46511, -1.47124, -1.47608, -1.47404, -1.4689, -1.45942, -1.44382, -1.41773, -1.382, -1.33534, -1.2773, -1.20683, -1.11842, -1.00989, -0.884558, -0.731281, -0.553083, -0.345267, -0.104138, 0.173261, 0.490877, 0.856397, 1.26589, 1.72961, 2.25038, 2.83411, 3.48157, 4.20122, 4.9981, 5.8756, 6.83587, 7.88444, 9.02529, 10.2617, 11.5945, 13.0273, 14.5642, 16.2023, 17.9408, 19.7771, 21.7116, 23.7398, 25.8572, 28.0586, 30.3358, 32.6853, 35.0972, 37.5631, 40.0749, 42.621, 45.1928, 47.7805, 50.3745, 52.9637, 55.5425, 58.0968, 60.6257, 63.1188, 65.5688, 67.9704, 70.3182, 72.6066, 74.8342, 76.9967, 79.0928, 81.1217, 83.0791, 84.9636, 86.7797, 88.5233, 90.1944, 91.7979, 93.3323, 94.7999, 96.2011, 97.5362, 98.8077, 100.018, 101.168, 102.258, 103.292, 104.269, 105.193, 106.064, 106.883, 107.654, 108.377, 109.053, 109.684, 110.271, 110.819, 111.323, 111.786, 112.211, 112.597, 112.949, 113.264, 113.542, 113.785, 113.999, 114.182, 114.334, 114.455, 114.546, 114.61, 114.646, 114.656, 114.638, 114.594, 114.527, 114.438, 114.324, 114.189, 114.03, 113.849, 113.646, 113.424, 113.18, 112.918, 112.633, 112.333, 112.012, 111.676, 111.318, 110.942, 110.554, 110.145, 109.718, 109.274, 108.811, 108.335, 107.844, 107.337, 106.81, 106.271, 105.716, 105.146, 104.56, 103.958, 103.344, 102.712, 102.065, 101.401, 100.723, 100.029, 99.3202, 98.5969, 97.855, 97.0954, 96.325, 95.5378, 94.732, 93.912, 93.0738, 92.219, 91.3482, 90.4575, 89.5515, 88.6302, 87.6907, 86.7331, 85.7577, 84.7659, 83.7582, 82.7324, 81.6874, 80.6261, 79.5495, 78.4544, 77.343, 76.2157, 75.0706, 73.908, 72.7329, 71.5433, 70.3384, 69.1182, 67.8873, 66.6441, 65.3897, 64.1239, 62.8501, 61.568, 60.2801, 58.9849, 57.6857, 56.3835, 55.0787, 53.7737, 52.469, 51.1655, 49.8666, 48.5737, 47.2869, 46.0074, 44.7368, 43.4766, 42.2291, 40.9953, 39.776, 38.5715, 37.3843, 36.2153, 35.0653, 33.9353, 32.8255, 31.7377, 30.6721, 29.6294, 28.6099, 27.6143, 26.6427, 25.6956, 24.7731, 23.8754, 23.0034, 22.1553, 21.3319, 20.5332, 19.7589, 19.0089, 18.2828, 17.5803, 16.9001, 16.2432, 15.6093, 14.9974, 14.407, 13.8383, 13.2895, 12.7607, 12.2515, 11.7612, 11.2893, 10.8353, 10.3986, 9.97871, 9.57508, 9.18717, 8.81447, 8.45602, 8.11111, 7.7815};
  }else if( val == "crex_fitFringe" ){
    magScaleFactor = 0.219;
    mg_field_low = -69*cm;
    mg_field_high = 61*cm;
  }else if( val == "crex_prevDefault" ){
    magScaleFactor = 0.219;
    mg_field_low = -69*cm;
    mg_field_high = 61*cm;
    zPosition = {-200, -199.5, -199, -198.5, -198, -197.5, -197, -196.5, -196, -195.5, -195, -194.5, -194, -193.5, -193, -192.5, -192, -191.5, -191, -190.5, -190, -189.5, -189, -188.5, -188, -187.5, -187, -186.5, -186, -185.5, -185, -184.5, -184, -183.5, -183, -182.5, -182, -181.5, -181, -180.5, -180, -179.5, -179, -178.5, -178, -177.5, -177, -176.5, -176, -175.5, -175, -174.5, -174, -173.5, -173, -172.5, -172, -171.5, -171, -170.5, -170, -169.5, -169, -168.5, -168, -167.5, -167, -166.5, -166, -165.5, -165, -164.5, -164, -163.5, -163, -162.5, -162, -161.5, -161, -160.5, -160, -159.5, -159, -158.5, -158, -157.5, -157, -156.5, -156, -155.5, -155, -154.5, -154, -153.5, -153, -152.5, -152, -151.5, -151, -150.5, -150, -149.5, -149, -148.5, -148, -147.5, -147, -146.5, -146, -145.5, -145, -144.5, -144, -143.5, -143, -142.5, -142, -141.5, -141, -140.5, -140, -139.5, -139, -138.5, -138, -137.5, -137, -136.5, -136, -135.5, -135, -134.5, -134, -133.5, -133, -132.5, -132, -131.5, -131, -130.5, -130, -129.5, -129, -128.5, -128, -127.5, -127, -126.5, -126, -125.5, -125, -124.5, -124, -123.5, -123, -122.5, -122, -121.5, -121, -120.5, -120, -119.5, -119, -118.5, -118, -117.5, -117, -116.5, -116, -115.5, -115, -114.5, -114, -113.5, -113, -112.5, -112, -111.5, -111, -110.5, -110, -109.5, -109, -108.5, -108, -107.5, -107, -106.5, -106, -105.5, -105, -104.5, -104, -103.5, -103, -102.5, -102, -101.5, -101, -100.5, -100, -99.5, -99, -98.5, -98, -97.5, -97, -96.5, -96, -95.5, -95, -94.5, -94, -93.5, -93, -92.5, -92, -91.5, -91, -90.5, -90, -89.5, -89, -88.5, -88, -87.5, -87, -86.5, -86, -85.5, -85, -84.5, -84, -83.5, -83, -82.5, -82, -81.5, -81, -80.5, -80, -79.5, -79, -78.5, -78, -77.5, -77, -76.5, -76, -75.5, -75, -74.5, -74, -73.5, -73, -72.5, -72, -71.5, -71, -70.5, -70, -69.5, -69, -68.5, -68, -67.5, -67, -66.5, -66, -65.5, -65, -64.5, -64, -63.5, -63, -62.5, -62, -61.5, -61, -60.5, -60, -59.5, -59, -58.5, -58, -57.5, -57, -56.5, -56, -55.5, -55, -54.5, -54, -53.5, -53, -52.5, -52, -51.5, -51, -50.5, -50, -49.5, -49, -48.5, -48, -47.5, -47, -46.5, -46, -45.5, -45, -44.5, -44, -43.5, -43, -42.5, -42, -41.5, -41, -40.5, -40, -39.5, -39, -38.5, -38, -37.5, -37, -36.5, -36, -35.5, -35, -34.5, -34, -33.5, -33, -32.5, -32, -31.5, -31, -30.5, -30, -29.5, -29, -28.5, -28, -27.5, -27, -26.5, -26, -25.5, -25, -24.5, -24, -23.5, -23, -22.5, -22, -21.5, -21, -20.5, -20, -19.5, -19, -18.5, -18, -17.5, -17, -16.5, -16, -15.5, -15, -14.5, -14, -13.5, -13, -12.5, -12, -11.5, -11, -10.5, -10, -9.5, -9, -8.5, -8, -7.5, -7, -6.5, -6, -5.5, -5, -4.5, -4, -3.5, -3, -2.5, -2, -1.5, -1, -0.5, 0, 0.5, 1, 1.5, 2, 2.5, 3, 3.5, 4, 4.5, 5, 5.5, 6, 6.5, 7, 7.5, 8, 8.5, 9, 9.5, 10, 10.5, 11, 11.5, 12, 12.5, 13, 13.5, 14, 14.5, 15, 15.5, 16, 16.5, 17, 17.5, 18, 18.5, 19, 19.5, 20, 20.5, 21, 21.5, 22, 22.5, 23, 23.5, 24, 24.5, 25, 25.5, 26, 26.5, 27, 27.5, 28, 28.5, 29, 29.5, 30, 30.5, 31, 31.5, 32, 32.5, 33, 33.5, 34, 34.5, 35, 35.5, 36, 36.5, 37, 37.5, 38, 38.5, 39, 39.5, 40, 40.5, 41, 41.5, 42, 42.5, 43, 43.5, 44, 44.5, 45, 45.5, 46, 46.5, 47, 47.5, 48, 48.5, 49, 49.5, 50, 50.5, 51, 51.5, 52, 52.5, 53, 53.5, 54, 54.5, 55, 55.5, 56, 56.5, 57, 57.5, 58, 58.5, 59, 59.5, 60, 60.5, 61, 61.5, 62, 62.5, 63, 63.5, 64, 64.5, 65, 65.5, 66, 66.5, 67, 67.5, 68, 68.5, 69, 69.5, 70, 70.5, 71, 71.5, 72, 72.5, 73, 73.5, 74, 74.5, 75, 75.5, 76, 76.5, 77, 77.5, 78, 78.5, 79, 79.5, 80, 80.5, 81, 81.5, 82, 82.5, 83, 83.5, 84, 84.5, 85, 85.5, 86, 86.5, 87, 87.5, 88, 88.5, 89, 89.5, 90, 90.5, 91, 91.5, 92, 92.5, 93, 93.5, 94, 94.5, 95, 95.5, 96, 96.5, 97, 97.5, 98, 98.5, 99, 99.5, 100, 100.5, 101, 101.5, 102, 102.5, 103, 103.5, 104, 104.5, 105, 105.5, 106, 106.5, 107, 107.5, 108, 108.5, 109, 109.5, 110, 110.5, 111, 111.5, 112, 112.5, 113, 113.5, 114, 114.5, 115, 115.5, 116, 116.5, 117, 117.5, 118, 118.5, 119, 119.5, 120, 120.5, 121, 121.5, 122, 122.5, 123, 123.5, 124, 124.5, 125, 125.5, 126, 126.5, 127, 127.5, 128, 128.5, 129, 129.5, 130, 130.5, 131, 131.5, 132, 132.5, 133, 133.5, 134, 134.5, 135, 135.5, 136, 136.5, 137, 137.5, 138, 138.5, 139, 139.5, 140, 140.5, 141, 141.5, 142, 142.5, 143, 143.5, 144, 144.5, 145, 145.5, 146, 146.5, 147, 147.5, 148, 148.5, 149, 149.5, 150, 150.5, 151, 151.5, 152, 152.5, 153, 153.5, 154, 154.5, 155, 155.5, 156, 156.5, 157, 157.5, 158, 158.5, 159, 159.5, 160, 160.5, 161, 161.5, 162, 162.5, 163, 163.5, 164, 164.5, 165, 165.5, 166, 166.5, 167, 167.5, 168, 168.5, 169, 169.5, 170, 170.5, 171, 171.5, 172, 172.5, 173, 173.5, 174, 174.5, 175, 175.5, 176, 176.5, 177, 177.5, 178, 178.5, 179, 179.5, 180, 180.5, 181, 181.5, 182, 182.5, 183, 183.5, 184, 184.5, 185, 185.5, 186, 186.5, 187, 187.5, 188, 188.5, 189, 189.5, 190, 190.5, 191, 191.5, 192, 192.5, 193, 193.5, 194, 194.5, 195, 195.5, 196, 196.5, 197, 197.5, 198, 198.5, 199, 199.5, 200};
    bXcomponent = {-0.00430807, -0.00434033, -0.00437288, -0.00440573, -0.00443886, -0.00447229, -0.00450602, -0.00454005, -0.00457438, -0.00460903, -0.00464399, -0.00467926, -0.00471486, -0.00475077, -0.00478701, -0.00482358, -0.00486048, -0.00489772, -0.00493529, -0.00497321, -0.00501147, -0.00505009, -0.00508906, -0.00512838, -0.00516807, -0.00520812, -0.00524854, -0.00528933, -0.0053305, -0.00537205, -0.00541399, -0.00545632, -0.00549903, -0.00554215, -0.00558503, -0.00562805, -0.0056734, -0.00572536, -0.00568739, -0.00582419, -0.00587284, -0.00591746, -0.00596254, -0.00600679, -0.00605403, -0.00610222, -0.00615086, -0.00619996, -0.00624953, -0.00629958, -0.00635009, -0.0064011, -0.00645259, -0.00650457, -0.00655706, -0.00661004, -0.00666354, -0.00671755, -0.00677208, -0.00682714, -0.00688274, -0.00693887, -0.00699555, -0.00705278, -0.00711056, -0.00716799, -0.00722854, -0.007288, -0.00734805, -0.00740869, -0.00746993, -0.00753177, -0.00759422, -0.00765729, -0.00772099, -0.00778532, -0.00785029, -0.00791591, -0.00798218, -0.00804912, -0.00811672, -0.008185, -0.00825397, -0.00832363, -0.008394, -0.00846507, -0.00853686, -0.00860938, -0.00868263, -0.00875663, -0.00883137, -0.00890688, -0.00898316, -0.00906022, -0.00917457, -0.00920469, -0.00927722, -0.00927508, -0.009441, -0.00943532, -0.00960808, -0.00969183, -0.00977645, -0.00986194, -0.00994833, -0.0100356, -0.0101238, -0.0102129, -0.0103029, -0.0103939, -0.0104859, -0.0105788, -0.0106726, -0.0107675, -0.0108634, -0.0109603, -0.0110582, -0.0111571, -0.0112571, -0.0113582, -0.0114603, -0.0115635, -0.0116679, -0.0117733, -0.0118799, -0.0119876, -0.0120965, -0.0122065, -0.0123178, -0.0124302, -0.0125438, -0.0126587, -0.0127749, -0.0128923, -0.0130109, -0.0131309, -0.0132522, -0.0133748, -0.0134988, -0.0136241, -0.0137508, -0.0138789, -0.0139842, -0.01413, -0.0142632, -0.0143979, -0.014534, -0.0146715, -0.0148105, -0.014951, -0.015093, -0.0152365, -0.015394, -0.0155393, -0.0156863, -0.0158351, -0.0159857, -0.0161381, -0.0162923, -0.0164483, -0.0166061, -0.0167658, -0.0169273, -0.0170908, -0.0172563, -0.0174236, -0.0175928, -0.0177641, -0.0179376, -0.0181128, -0.0182901, -0.0184694, -0.0186513, -0.0188342, -0.01902, -0.019208, -0.0193981, -0.0195881, -0.0197841, -0.0199811, -0.0201804, -0.020382, -0.0205859, -0.0207924, -0.0210012, -0.0212126, -0.0214265, -0.0216429, -0.0218619, -0.0220835, -0.0223078, -0.0225347, -0.0227644, -0.0229968, -0.023232, -0.0234701, -0.0237111, -0.0239549, -0.0242017, -0.0244516, -0.0247044, -0.0249604, -0.0252194, -0.0254817, -0.0257471, -0.0260158, -0.0262878, -0.0265723, -0.0268434, -0.0271255, -0.0274111, -0.0277003, -0.0279931, -0.0282895, -0.0285896, -0.0288935, -0.0292012, -0.0295127, -0.0298282, -0.0301476, -0.0304711, -0.0307986, -0.0311303, -0.0314662, -0.0318063, -0.0321508, -0.0324997, -0.032853, -0.0332108, -0.0335732, -0.0339403, -0.0343121, -0.0346887, -0.0350701, -0.0354565, -0.0358478, -0.0362442, -0.0366458, -0.0370526, -0.0374647, -0.0378822, -0.0383051, -0.0387336, -0.0391677, -0.0396075, -0.0400531, -0.0405046, -0.040962, -0.0414255, -0.0418951, -0.042371, -0.0428532, -0.0433418, -0.043837, -0.0443387, -0.0448472, -0.0453625, -0.0458848, -0.046414, -0.0469504, -0.0474941, -0.0480451, -0.0486036, -0.0491696, -0.0497434, -0.050325, -0.0509145, -0.0515121, -0.0521178, -0.0527319, -0.0533544, -0.0539855, -0.0546252, -0.0552738, -0.0559314, -0.0565981, -0.057274, -0.0579594, -0.0586543, -0.0593588, -0.0600732, -0.0607976, -0.0615322, -0.0622771, -0.0630324, -0.0637984, -0.0645752, -0.065363, -0.0661619, -0.0669721, -0.0677939, -0.0686273, -0.0694726, -0.0703299, -0.0711995, -0.0720816, -0.0729763, -0.0738838, -0.0748044, -0.0757383, -0.0766856, -0.0776465, -0.0786214, -0.0796104, -0.0806138, -0.0816317, -0.0826645, -0.0837123, -0.0847754, -0.085854, -0.0869484, -0.0880589, -0.0891857, -0.090329, -0.0914891, -0.0926666, -0.0938611, -0.0950957, -0.0963004, -0.0975486, -0.0988155, -0.100101, -0.101406, -0.10273, -0.104074, -0.105438, -0.106822, -0.108227, -0.109654, -0.111101, -0.11257, -0.114062, -0.115576, -0.117112, -0.118672, -0.120256, -0.121863, -0.123495, -0.125151, -0.126833, -0.12854, -0.130273, -0.132033, -0.13382, -0.135632, -0.137473, -0.139342, -0.141239, -0.143153, -0.145127, -0.14712, -0.14913, -0.15118, -0.153259, -0.155371, -0.157515, -0.159694, -0.1619, -0.164145, -0.166424, -0.168736, -0.171087, -0.173473, -0.175896, -0.178356, -0.180855, -0.183399, -0.185968, -0.188584, -0.19124, -0.193938, -0.196681, -0.199875, -0.202279, -0.205146, -0.208058, -0.211014, -0.214017, -0.217065, -0.22016, -0.223303, -0.226156, -0.228827, -0.233025, -0.236366, -0.239759, -0.243203, -0.2467, -0.250251, -0.253856, -0.257516, -0.261232, -0.265004, -0.268834, -0.272722, -0.276669, -0.280675, -0.284742, -0.288871, -0.293061, -0.297314, -0.301631, -0.306012, -0.310458, -0.314971, -0.31955, -0.324197, -0.328912, -0.333697, -0.338551, -0.343476, -0.348472, -0.353541, -0.358682, -0.363897, -0.369186, -0.374551, -0.379991, -0.385508, -0.391101, -0.396772, -0.402522, -0.40835, -0.414258, -0.420246, -0.426314, -0.432464, -0.438693, -0.445002, -0.451395, -0.457866, -0.464426, -0.472291, -0.477785, -0.484595, -0.492415, -0.498864, -0.505515, -0.513149, -0.520132, -0.527192, -0.534584, -0.542059, -0.549205, -0.55688, -0.564594, -0.57245, -0.580746, -0.588702, -0.59675, -0.604508, -0.612649, -0.620863, -0.629192, -0.637603, -0.645863, -0.654533, -0.663513, -0.672234, -0.679987, -0.688756, -0.697703, -0.706613, -0.715505, -0.724515, -0.733552, -0.742587, -0.751717, -0.760862, -0.770056, -0.779256, -0.788475, -0.797715, -0.806965, -0.816221, -0.825481, -0.834736, -0.843983, -0.853214, -0.862426, -0.871612, -0.880762, -0.889883, -0.898987, -0.908044, -0.916817, -0.925819, -0.934597, -0.943385, -0.952039, -0.960347, -0.969057, -0.977197, -0.985404, -0.993763, -1.00109, -1.00899, -1.01731, -1.02475, -1.03214, -1.03941, -1.04648, -1.05333, -1.05879, -1.06526, -1.07295, -1.07919, -1.08522, -1.091, -1.0966, -1.102, -1.10722, -1.11125, -1.11609, -1.12072, -1.12526, -1.1311, -1.13532, -1.13939, -1.14476, -1.14863, -1.15367, -1.15712, -1.16119, -1.16394, -1.16762, -1.17133, -1.17568, -1.17906, -1.18309, -1.18811, -1.19114, -1.19506, -1.19982, -1.20573, -1.21276, -1.21511, -1.22155, -1.22806, -1.23559, -1.2438, -1.25609, -1.26549, -1.27557, -1.28751, -1.29746, -1.30933, -1.32235, -1.33639, -1.34699, -1.36114, -1.37597, -1.39085, -1.4064, -1.41968, -1.43307, -1.4453, -1.45602, -1.46511, -1.47124, -1.47608, -1.47404, -1.4689, -1.45942, -1.44382, -1.41773, -1.382, -1.33534, -1.2773, -1.20683, -1.11842, -1.00989, -0.884558, -0.731281, -0.553083, -0.345267, -0.104138, 0.173261, 0.490877, 0.856397, 1.26589, 1.72961, 2.25038, 2.83411, 3.48157, 4.20122, 4.9981, 5.8756, 6.83587, 7.88444, 9.02529, 10.2617, 11.5945, 13.0273, 14.5642, 16.2023, 17.9408, 19.7771, 21.7116, 23.7398, 25.8572, 28.0586, 30.3358, 32.6853, 35.0972, 37.5631, 40.0749, 42.621, 45.1928, 47.7805, 50.3745, 52.9637, 55.5425, 58.0968, 60.6257, 63.1188, 65.5688, 67.9704, 70.3182, 72.6066, 74.8342, 76.9967, 79.0928, 81.1217, 83.0791, 84.9636, 86.7797, 88.5233, 90.1944, 91.7979, 93.3323, 94.7999, 96.2011, 97.5362, 98.8077, 100.018, 101.168, 102.258, 103.292, 104.269, 105.193, 106.064, 106.883, 107.654, 108.377, 109.053, 109.684, 110.271, 110.819, 111.323, 111.786, 112.211, 112.597, 112.949, 113.264, 113.542, 113.785, 113.999, 114.182, 114.334, 114.455, 114.546, 114.61, 114.646, 114.656, 114.638, 114.594, 114.527, 114.438, 114.324, 114.189, 114.03, 113.849, 113.646, 113.424, 113.18, 112.918, 112.633, 112.333, 112.012, 111.676, 111.318, 110.942, 110.554, 110.145, 109.718, 109.274, 108.811, 108.335, 107.844, 107.337, 106.81, 106.271, 105.716, 105.146, 104.56, 103.958, 103.344, 102.712, 102.065, 101.401, 100.723, 100.029, 99.3202, 98.5969, 97.855, 97.0954, 96.325, 95.5378, 94.732, 93.912, 93.0738, 92.219, 91.3482, 90.4575, 89.5515, 88.6302, 87.6907, 86.7331, 85.7577, 84.7659, 83.7582, 82.7324, 81.6874, 80.6261, 79.5495, 78.4544, 77.343, 76.2157, 75.0706, 73.908, 72.7329, 71.5433, 70.3384, 69.1182, 67.8873, 66.6441, 65.3897, 64.1239, 62.8501, 61.568, 60.2801, 58.9849, 57.6857, 56.3835, 55.0787, 53.7737, 52.469, 51.1655, 49.8666, 48.5737, 47.2869, 46.0074, 44.7368, 43.4766, 42.2291, 40.9953, 39.776, 38.5715, 37.3843, 36.2153, 35.0653, 33.9353, 32.8255, 31.7377, 30.6721, 29.6294, 28.6099, 27.6143, 26.6427, 25.6956, 24.7731, 23.8754, 23.0034, 22.1553, 21.3319, 20.5332, 19.7589, 19.0089, 18.2828, 17.5803, 16.9001, 16.2432, 15.6093, 14.9974, 14.407, 13.8383, 13.2895, 12.7607, 12.2515, 11.7612, 11.2893, 10.8353, 10.3986, 9.97871, 9.57508, 9.18717, 8.81447, 8.45602, 8.11111, 7.7815};
  }else if( val == "pvdis" || val == "moller" || val == "happex3" || val == "apex"){
    magScaleFactor = 0.;
    mg_field_low = -1*cm;
    mg_field_high = 1*cm;
  }else if( val == "prex2JayNoQ1shield" ){
    magScaleFactor = 0.;
    mg_field_low = -69*cm;
    mg_field_high = 61*cm;
    zPosition = {-150, -149, -148, -147, -146, -145, -144, -143, -142, -141, -140, -139, -138, -137, -136, -135, -134, -133, -132, -131, -130, -129, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174};
    bXcomponent = {0.0728281, 0.075808, 0.078833, 0.0823115, 0.0856705, 0.0891343, 0.0931149, 0.0970995, 0.10171, 0.10642, 0.111182, 0.116345, 0.121896, 0.127917, 0.134137, 0.140724, 0.147967, 0.155318, 0.163479, 0.172111, 0.181239, 0.191141, 0.201398, 0.212777, 0.224964, 0.237372, 0.251483, 0.266231, 0.282178, 0.298882, 0.317287, 0.337478, 0.35918, 0.381725, 0.40625, 0.432989, 0.462344, 0.493603, 0.527746, 0.563954, 0.603615, 0.646841, 0.693797, 0.744379, 0.801558, 0.861179, 0.926598, 0.999623, 1.07681, 1.16325, 1.25686, 1.35935, 1.47316, 1.59605, 1.73025, 1.87879, 2.04212, 2.2221, 2.41942, 2.63494, 2.87619, 3.14017, 3.42897, 3.75122, 4.09998, 4.48779, 4.91846, 5.38524, 5.89961, 6.45835, 7.06114, 7.70858, 8.38305, 9.06055, 9.70404, 10.2419, 10.5377, 10.3938, 9.5522, 7.99683, 5.43267, 2.79713, 1.11352, 0.414049, 0.175989, 0.0907633, 0.124047, 0.0558988, 0.0856682, 0.124822, 0.167909, 0.101764, 0.0357052, 0.0288874, 0.109151, 0.108803, 0.158229, 0.210674, 0.202542, 0.246415, 0.214356, 0.129125, 0.468427, 0.18367, 0.388469, 0.323168, 0.152423, 0.388072, 0.296276, 0.465556, 0.685056, 0.498752, 0.455537, 0.983978, 0.565098, 0.555174, 0.851792, 0.869369, 0.706933, 0.909017, 1.07839, 0.985788, 1.10645, 1.16296, 1.61353, 1.44263, 1.22144, 1.04992, 1.1031, 1.1587, 1.17525, 1.09085, 1.33104, 1.22219, 1.49931, 1.38971, 1.61547, 1.35951, 1.18252, 1.39137, 1.20151, 1.4546, 1.32984, 1.62359, 1.41397, 1.42232, 1.40386, 1.42489, 1.37653, 1.27986, 1.46943, 1.41552, 1.49648, 1.67792, 1.50735, 1.52604, 1.39059, 1.45207, 1.30051, 1.32533, 1.30914, 1.49711, 1.00011, 1.1198, 1.31957, 1.3486, 1.35079, 1.27805, 1.17749, 1.09163, 1.47485, 1.44311, 1.28261, 1.33618, 1.26599, 1.27086, 0.992453, 1.11491, 1.23847, 1.01412, 0.943705, 0.883125, 0.959009, 0.998756, 0.700986, 0.836848, 0.470217, 0.551737, 0.965171, 0.571862, 0.301591, 0.410559, 0.382439, 0.308291, 0.260744, 0.572712, 0.324628, 0.0998761, 0.338618, 0.1719, 0.0818992, 0.130889, 0.139845, 0.100154, 0.119569, 0.111514, 0.123674, 0.138994, -0.0479585, 0.0601757, 0.102417, 0.125339, 0.0439248, 0.0277636, 0.0141836, -0.00147643, 0.0688325, 0.0319183, 0.0368759, 0.033483, 0.18506, 0.524566, 1.32356, 2.59907, 3.91604, 4.9403, 5.56867, 5.76885, 5.70464, 5.44133, 5.06683, 4.62874, 4.16944, 3.70874, 3.25126, 2.8214, 2.4004, 2.00649, 1.62612, 1.26115, 0.900462, 0.533443, 0.102836, -0.392314, -1.0196, -1.86667, -2.91716, -4.31238, -5.99063, -7.93874, -9.99622, -12.2537, -14.4541, -16.4897, -18.433, -20.0363, -21.4591, -22.5366, -23.357, -23.9406, -24.2779, -24.3852, -24.3159, -24.0933, -23.7503, -23.279, -22.7834, -22.1947, -21.5673, -20.9295, -20.2416, -19.5995, -18.9291, -18.2636, -17.6187, -16.9591, -16.3386, -15.7565, -15.1753, -14.601, -14.0672, -13.5503, -13.0534, -12.5819, -12.1161, -11.6843, -11.2569, -10.8566, -10.4578, -10.0838, -9.69988, -9.35048, -9.0203, -8.67847, -8.36719, -8.05585, -7.76756, -7.48441, -7.20888, -6.94377, -6.68832, -6.44405, -6.20901, -5.97792, -5.73719, -5.51955, -5.29229, -5.08008, -4.85828, -4.65402, -4.45122, -4.25021, -4.04542, -3.84657, -3.65092, -3.46309, -3.25128, -3.05554, -2.86294, -2.67545, -2.48743, -2.29597, -2.11481, -1.93791, -1.76524};
  }else if( val == "crexJayNoQ1shield" ){
    magScaleFactor = 0.;
    mg_field_low = -69*cm;
    mg_field_high = 61*cm;
    zPosition = {-150, -149, -148, -147, -146, -145, -144, -143, -142, -141, -140, -139, -138, -137, -136, -135, -134, -133, -132, -131, -130, -129, -128, -127, -126, -125, -124, -123, -122, -121, -120, -119, -118, -117, -116, -115, -114, -113, -112, -111, -110, -109, -108, -107, -106, -105, -104, -103, -102, -101, -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174};
    bXcomponent = {0.138941, 0.144677, 0.150495, 0.157198, 0.163661, 0.170325, 0.178004, 0.185685, 0.19459, 0.203687, 0.212883, 0.222861, 0.233595, 0.245242, 0.257272, 0.270015, 0.28404, 0.29827, 0.314083, 0.33081, 0.348506, 0.36772, 0.387628, 0.409729, 0.433403, 0.457504, 0.484939, 0.513614, 0.544635, 0.57714, 0.612976, 0.652299, 0.694578, 0.738504, 0.78631, 0.838455, 0.895723, 0.95672, 1.02337, 1.09406, 1.17152, 1.25598, 1.34776, 1.44665, 1.55849, 1.67513, 1.80315, 1.94609, 2.09723, 2.26651, 2.4499, 2.65073, 2.87378, 3.11473, 3.3779, 3.66928, 3.98976, 4.34297, 4.73031, 5.15354, 5.62729, 6.14583, 6.71333, 7.34658, 8.03223, 8.79475, 9.64157, 10.5598, 11.5716, 12.6712, 13.8577, 15.1322, 16.4603, 17.7948, 19.063, 20.1249, 20.7099, 20.4361, 18.8005, 15.7425, 10.6749, 5.50007, 2.19507, 0.820853, 0.356229, 0.191578, 0.263307, 0.134287, 0.203028, 0.294192, 0.398643, 0.292108, 0.194734, 0.226891, 0.445909, 0.520999, 0.716013, 0.939106, 1.06608, 1.32766, 1.47182, 1.53865, 2.50649, 2.26865, 3.0644, 3.39867, 3.69993, 5.04009, 6.13855, 8.48485, 11.8372, 16.1971, 22.2288, 30.4853, 39.0192, 48.8074, 59.9654, 70.4663, 81.0034, 90.6966, 99.9613, 107.003, 114.734, 120.605, 125.287, 129.576, 132.767, 135.628, 138.76, 140.001, 141.517, 143.04, 143.952, 144.982, 146.545, 146.948, 146.812, 148.252, 147.936, 148.52, 148.472, 149.358, 148.981, 149.383, 150.21, 149.517, 149.814, 150.11, 149.303, 150.83, 149.961, 149.988, 150.183, 149.174, 148.714, 149.847, 149.291, 149.127, 148.563, 148.979, 148.101, 148.82, 147.761, 147.839, 147.024, 146.583, 145.556, 145.398, 144.568, 142.689, 142.58, 140.091, 137.791, 136.23, 134.217, 129.18, 124.837, 119.96, 113.997, 106.455, 99.1351, 90.7821, 80.3549, 71.0045, 59.7732, 49.3098, 38.5107, 29.5927, 22.4394, 15.9113, 10.8313, 7.91303, 5.81161, 4.36342, 3.38009, 3.36543, 2.38858, 1.5482, 1.70739, 1.11425, 0.723074, 0.645293, 0.538525, 0.373348, 0.354838, 0.301525, 0.300805, 0.314755, -0.0701136, 0.138163, 0.217053, 0.258984, 0.0934652, 0.0592276, 0.0307569, -0.00153214, 0.138247, 0.0641054, 0.0733177, 0.064796, 0.363881, 1.02031, 2.60078, 5.1112, 7.70051, 9.7145, 10.9528, 11.328, 11.2133, 10.6943, 9.95703, 9.09352, 8.18929, 7.28196, 6.38152, 5.53498, 4.70605, 3.93018, 3.18079, 2.46061, 1.75299, 1.02354, 0.174835, -0.803618, -2.04348, -3.72242, -5.80708, -8.5702, -11.8996, -15.7667, -19.8529, -24.3388, -28.7148, -32.7665, -36.6382, -39.8365, -42.6785, -44.8349, -46.4808, -47.6552, -48.3387, -48.5631, -48.4341, -47.9987, -47.321, -46.3864, -45.4022, -44.2314, -42.9825, -41.7125, -40.342, -39.0628, -37.7273, -36.4016, -35.1172, -33.8039, -32.5687, -31.4106, -30.2543, -29.1119, -28.0503, -27.0225, -26.0345, -25.0972, -24.1708, -23.3122, -22.4624, -21.6663, -20.873, -20.1289, -19.3648, -18.6695, -18.0124, -17.3318, -16.7121, -16.0921, -15.518, -14.9542, -14.4055, -13.8775, -13.3688, -12.8824, -12.4144, -11.9543, -11.4748, -11.0415, -10.5888, -10.1662, -9.72422, -9.31724, -8.91307, -8.51233, -8.10387, -7.70717, -7.3167, -6.94176, -6.51875, -6.12776, -5.74296, -5.36828, -4.99248, -4.60972, -4.24752, -3.8938, -3.54848};
  }else if( val == "test" ){
    magScaleFactor = 0.;
    mg_field_low = -69*cm;
    mg_field_high = 61*cm;
    zPosition = {-100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74};
    bXcomponent = {0.419498, 0.156615, 0.0454327, 0.014793, 0.00707363, 0.00667293, 0.00712018, 0.00807449, 0.00772326, 0.00931942, 0.00939836, 0.0125564, 0.0123927, 0.0134185, 0.0149516, 0.0185699, 0.0178983, 0.0194843, 0.0279218, 0.0230807, 0.0320728, 0.0300206, 0.0344592, 0.037722, 0.0375748, 0.044933, 0.0485245, 0.0454311, 0.0575277, 0.0541997, 0.0703473, 0.0828506, 0.0870898, 0.08958, 0.0958338, 0.0817063, 0.101683, 0.110764, 0.122125, 0.143025, 0.1317, 0.190063, 0.229665, 0.211515, 0.261886, 0.300907, 0.330306, 0.371168, 0.345508, 0.442862, 0.424287, 0.502604, 0.552064, 0.664654, 0.66921, 0.897531, 0.942195, 1.12033, 1.29621, 1.58901, 1.84467, 2.38836, 2.91364, 3.5918, 4.44432, 5.72389, 6.90249, 8.44373, 9.86583, 11.3813, 12.9183, 14.2869, 15.5491, 16.7273, 17.7773, 18.8133, 19.5561, 20.2231, 20.9652, 21.4078, 22.0609, 22.5017, 22.8992, 23.2686, 23.513, 23.8681, 24.1404, 24.4143, 24.6537, 24.775, 25.0184, 25.1533, 25.2616, 25.4113, 25.4381, 25.5231, 25.6323, 25.6863, 25.7184, 25.7366, 25.762, 25.7728, 25.7384, 25.7065, 25.6565, 25.5842, 25.4817, 25.3712, 25.2497, 25.1685, 24.9752, 24.8518, 24.6173, 24.3412, 24.1787, 23.9198, 23.5779, 23.1956, 22.9396, 22.4855, 22.0622, 21.5261, 20.905, 20.3301, 19.5847, 18.7188, 17.8594, 16.7767, 15.4549, 14.2095, 12.8743, 11.2998, 9.81095, 8.33398, 6.89597, 5.57885, 4.56738, 3.61393, 2.78312, 2.3956, 1.85897, 1.50433, 1.26175, 0.998575, 0.938605, 0.660952, 0.597472, 0.504381, 0.515868, 0.418623, 0.412548, 0.373026, 0.350377, 0.29457, 0.248399, 0.221327, 0.236266, 0.164801, 0.190547, 0.138104, 0.130611, 0.113427, 0.120042, 0.0926598, 0.0670554, 0.0804655, 0.0603172, 0.0648828, 0.0503632, 0.0608466, 0.0591683, 0.0565922, 0.0352081, 0.0337959, 0.0298959};
  }else if( val == "prex2UpdatedSeptumShield_allOn" ){
    magScaleFactor = 0.;
    mg_field_low = -69*cm;
    mg_field_high = 61*cm;
    zPosition = { -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200};
    bXcomponent = { 1.1594, 1.25829, 1.36771, 1.48691, 1.61807, 1.76214, 1.92092, 2.09558, 2.28727, 2.49863, 2.73143, 2.98779, 3.27013, 3.5816, 3.92421, 4.3016, 4.71433, 5.16639, 5.65783, 6.18972, 6.75363, 7.33806, 7.91237, 8.4132, 8.71973, 8.57815, 7.64243, 5.66151, 3.05528, 1.20303, 0.417454, 0.188682, 0.119386, 0.122099, 0.120181, 0.133809, 0.131607, 0.156253, 0.143806, 0.184695, 0.199276, 0.199601, 0.246561, 0.245728, 0.276907, 0.326116, 0.313485, 0.360675, 0.377775, 0.402888, 0.415701, 0.417292, 0.49172, 0.500251, 0.462294, 0.513523, 0.51402, 0.508461, 0.583067, 0.61873, 0.668288, 0.742027, 0.764405, 0.844687, 0.86534, 0.939934, 1.01391, 1.06574, 1.0725, 1.12998, 1.19523, 1.21607, 1.2235, 1.23208, 1.25379, 1.21736, 1.2, 1.33078, 1.27503, 1.30697, 1.25988, 1.33848, 1.33232, 1.3263, 1.25134, 1.33823, 1.30691, 1.33169, 1.32817, 1.32592, 1.33109, 1.31278, 1.30436, 1.30005, 1.29267, 1.30242, 1.315, 1.30229, 1.26654, 1.33082, 1.30478, 1.2931, 1.33176, 1.31584, 1.38373, 1.31997, 1.39826, 1.28726, 1.28266, 1.28858, 1.3247, 1.3188, 1.2978, 1.32262, 1.30543, 1.3446, 1.31211, 1.35152, 1.30927, 1.29753, 1.33086, 1.28973, 1.34183, 1.31417, 1.26546, 1.28376, 1.3066, 1.17921, 1.22976, 1.21477, 1.18125, 1.17158, 1.05878, 1.02, 1.03849, 0.942725, 0.850555, 0.841267, 0.794991, 0.713341, 0.629213, 0.609895, 0.528279, 0.56, 0.489272, 0.52943, 0.48818, 0.422036, 0.441216, 0.375917, 0.343274, 0.298973, 0.288405, 0.328872, 0.389946, 0.439405, 0.441948, 0.430496, 0.393025, 0.325325, 0.311138, 0.248962, 0.245196, 0.231715, 0.231415, 0.207082, 0.218179, 0.276606, 0.400138, 0.704357, 1.2675, 2.13102, 3.28888, 4.44374, 5.41337, 6.02816, 6.26712, 6.20828, 5.94852, 5.56176, 5.10454, 4.61841, 4.12558, 3.64229, 3.17583, 2.72943, 2.30719, 1.90343, 1.52066, 1.14719, 0.779829, 0.398045, -0.025281, -0.530835, -1.15399, -1.97949, -3.04234, -4.38779, -6.03066, -7.92908, -10.016, -12.1722, -14.3437, -16.394, -18.2423, -19.8541, -21.195, -22.2583, -23.0526, -23.6039, -23.9207, -24.0407, -23.9789, -23.7692, -23.426, -22.9875, -22.4743, -21.8987, -21.2879, -20.6531, -20.0045, -19.3469, -18.6767, -18.0251, -17.385, -16.7595, -16.1489, -15.5586, -14.9868, -14.4376, -13.9041, -13.402, -12.9173, -12.4594, -12.0151, -11.5797, -11.1677, -10.7663, -10.3774, -10.0031, -9.64547, -9.29986, -8.97185, -8.65241, -8.34816, -8.05281, -7.77371, -7.50116, -7.23815, -6.98159, -6.7306, -6.48584, -6.24204, -6.00282, -5.76949, -5.54007, -5.31346, -5.09465, -4.88193, -4.67483, -4.47016, -4.26903, -4.07464, -3.87765, -3.69048, -3.50208, -3.32119, -3.14303, -2.9759, -2.81772, -2.67702, -2.55333, -2.43211, -2.29842, -2.12261, -1.91251, -1.69032, -1.47212, -1.27352, -1.10016, -0.944162, -0.814056, -0.698951, -0.598999, -0.514139, -0.43929, -0.373837, -0.319527, -0.2725, -0.228485, -0.191646, -0.156369, -0.126709, -0.0991072, -0.0765174, -0.0581335, -0.0475352, -0.041089, -0.0402449, -0.0421084, -0.0439111};
  }else if( val == "crexUpdatedSeptumShield_allOn" ){
    magScaleFactor = 0.;
    mg_field_low = -69*cm;
    mg_field_high = 61*cm;
    zPosition = { -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200};
    bXcomponent = { 2.27078, 2.465, 2.67991, 2.91408, 3.17172, 3.4548, 3.76681, 4.11002, 4.48679, 4.90225, 5.35995, 5.86401, 6.41922, 7.03173, 7.70555, 8.44784, 9.25971, 10.149, 11.1158, 12.1622, 13.2717, 14.4215, 15.5515, 16.537, 17.1406, 16.8642, 15.0238, 11.118, 6.00725, 2.36589, 0.821395, 0.371709, 0.234963, 0.24069, 0.236837, 0.263987, 0.259461, 0.308632, 0.2837, 0.365502, 0.39493, 0.396182, 0.491263, 0.49161, 0.557289, 0.660893, 0.643681, 0.749842, 0.801115, 0.87532, 0.933898, 0.981392, 1.18948, 1.28496, 1.31021, 1.54817, 1.72228, 1.93022, 2.36196, 2.78903, 3.34587, 4.06815, 4.83506, 5.8737, 6.97945, 8.34954, 9.8507, 11.4477, 12.9982, 14.671, 16.3299, 17.8713, 19.2926, 20.6452, 21.8956, 23.0087, 23.9757, 25.193, 25.9496, 26.7966, 27.4753, 28.28, 28.8919, 29.4383, 29.8214, 30.4573, 30.8362, 31.2489, 31.6282, 31.9319, 32.2445, 32.4489, 32.6809, 32.8802, 33.0422, 33.2063, 33.3474, 33.4054, 33.4118, 33.5667, 33.5478, 33.5002, 33.5321, 33.4461, 33.4579, 33.2208, 33.2217, 32.8487, 32.6426, 32.4308, 32.2327, 31.9332, 31.5537, 31.2609, 30.8222, 30.4514, 29.9224, 29.472, 28.8381, 28.197, 27.5856, 26.773, 26.0692, 25.1423, 24.1041, 23.091, 22.0129, 20.5393, 19.3479, 17.8584, 16.2987, 14.7517, 12.9729, 11.3499, 9.87472, 8.31311, 6.89965, 5.81207, 4.85421, 3.94593, 3.2039, 2.7095, 2.18968, 1.97913, 1.61862, 1.53295, 1.32199, 1.09437, 1.06417, 0.886144, 0.79345, 0.701333, 0.722548, 0.922755, 1.20221, 1.39693, 1.40379, 1.32315, 1.16952, 0.95654, 0.859304, 0.678819, 0.626078, 0.564132, 0.536762, 0.468031, 0.474631, 0.578516, 0.812851, 1.40514, 2.5079, 4.20065, 6.47305, 8.73914, 10.6452, 11.848, 12.3156, 12.1983, 11.6866, 10.9256, 10.0263, 9.07049, 8.1017, 7.15178, 6.235, 5.35771, 4.52775, 3.73406, 2.98124, 2.24705, 1.5222, 0.768514, -0.0689116, -1.07094, -2.30797, -3.94837, -6.0617, -8.73802, -12.0069, -15.7853, -19.9404, -24.2354, -28.5633, -32.6527, -36.3428, -39.5649, -42.2498, -44.3837, -45.9825, -47.0979, -47.7455, -48.0001, -47.8914, -47.4864, -46.8139, -45.9496, -44.9349, -43.794, -42.5814, -41.3192, -40.0282, -38.7177, -37.3807, -36.0796, -34.8005, -33.5494, -32.3274, -31.1451, -29.9994, -28.8982, -27.828, -26.8201, -25.8466, -24.9264, -24.0332, -23.1577, -22.3289, -21.5213, -20.7386, -19.9854, -19.2655, -18.5699, -17.9097, -17.2668, -16.6546, -16.0604, -15.4989, -14.9507, -14.4219, -13.9063, -13.402, -12.9104, -12.4209, -11.9409, -11.4728, -11.0127, -10.5583, -10.1198, -9.69355, -9.27874, -8.86899, -8.4665, -8.07769, -7.68395, -7.31009, -6.93405, -6.57336, -6.21844, -5.88584, -5.57146, -5.2923, -5.04738, -4.80764, -4.54304, -4.19426, -3.7769, -3.33534, -2.90179, -2.50743, -2.16349, -1.85423, -1.59661, -1.36883, -1.17117, -1.0035, -0.855691, -0.72649, -0.619382, -0.526668, -0.439846, -0.367232, -0.297619, -0.239132, -0.184672, -0.140163, -0.10401, -0.0833614, -0.0709575, -0.0697032, -0.0738222, -0.0777705};
  }else if( val == "crex_2PipeSeptumShield_allOn" ){
    magScaleFactor = 0.;
    mg_field_low = -69*cm;
    mg_field_high = 61*cm;
    zPosition = { -100, -99, -98, -97, -96, -95, -94, -93, -92, -91, -90, -89, -88, -87, -86, -85, -84, -83, -82, -81, -80, -79, -78, -77, -76, -75, -74, -73, -72, -71, -70, -69, -68, -67, -66, -65, -64, -63, -62, -61, -60, -59, -58, -57, -56, -55, -54, -53, -52, -51, -50, -49, -48, -47, -46, -45, -44, -43, -42, -41, -40, -39, -38, -37, -36, -35, -34, -33, -32, -31, -30, -29, -28, -27, -26, -25, -24, -23, -22, -21, -20, -19, -18, -17, -16, -15, -14, -13, -12, -11, -10, -9, -8, -7, -6, -5, -4, -3, -2, -1, 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159, 160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200};
    bXcomponent = { 2.41298, 2.61321, 2.83308, 3.07301, 3.33656, 3.62531, 3.94354, 4.29036, 4.67368, 5.09339, 5.55525, 6.06398, 6.6226, 7.23608, 7.91061, 8.65367, 9.46214, 10.3503, 11.3144, 12.3595, 13.4825, 14.6754, 15.9169, 17.1743, 18.3876, 19.4664, 20.2575, 20.5329, 20.0242, 18.5968, 15.9431, 12.3969, 8.50982, 5.21915, 2.97587, 1.70391, 1.04259, 0.70315, 0.611573, 0.528349, 0.442122, 0.318388, 0.254277, 0.294869, 0.278005, 0.3852, 0.510905, 0.701446, 0.9298, 1.1653, 1.36855, 1.70569, 2.09486, 2.49027, 2.66731, 2.88319, 2.82139, 2.05984, 1.0109, 0.330744, 0.195907, 0.0955217, 0.144723, 0.254628, 0.238289, 0.356474, 0.337882, 0.38792, 0.308404, 0.367454, 0.488556, 0.662361, 0.558418, 0.569154, 0.602443, 0.696601, 0.644866, 0.680229, 0.623555, 0.688702, 0.647147, 0.696406, 0.681136, 0.656045, 0.741141, 0.687499, 0.63111, 0.642673, 0.671599, 0.716962, 0.653977, 0.785197, 0.800104, 0.763595, 0.77521, 0.703667, 0.81765, 0.762448, 0.723699, 0.746061, 0.70171, 0.661959, 0.672924, 0.696128, 0.736053, 0.72765, 0.758591, 0.776429, 0.728385, 0.778379, 0.666087, 0.716185, 0.779403, 0.792557, 0.692897, 0.634442, 0.7296, 0.758556, 0.714478, 0.721477, 0.826022, 0.784667, 0.761172, 0.736819, 0.685888, 0.668662, 0.705245, 0.670538, 0.650214, 0.769435, 0.6, 0.562686, 0.616875, 0.479728, 0.404563, 0.391851, 0.231132, 0.186101, 0.171636, 0.244866, 0.0751232, 0.0422769, 0.0891299, 0.0799458, 0.0450753, -0.0220771, -0.114969, -0.074661, 0.0148294, -0.0088011, -0.171706, -0.0148932, 0.494926, 2.22811, 5.9669, 10.6693, 13.605, 14.256, 13.4837, 11.8863, 9.99379, 8.20852, 6.59814, 5.27236, 4.24109, 3.4558, 2.94316, 2.5643, 2.41876, 2.40445, 2.59868, 2.96499, 3.47913, 4.14863, 4.83289, 5.52018, 6.07952, 6.4466, 6.63051, 6.61358, 6.42299, 6.09151, 5.65977, 5.15434, 4.60559, 4.03103, 3.44275, 2.84935, 2.25748, 1.66134, 1.04306, 0.372485, -0.39272, -1.33954, -2.55565, -4.15623, -6.27619, -8.94748, -12.2019, -15.9761, -20.1669, -24.5587, -28.8839, -33.0187, -36.7635, -39.9967, -42.6777, -44.7939, -46.4033, -47.4885, -48.1346, -48.3597, -48.2057, -47.7417, -47.0522, -46.145, -45.1042, -43.9386, -42.6944, -41.4043, -40.0778, -38.7365, -37.4047, -36.0972, -34.8108, -33.5629, -32.3463, -31.1647, -30.0114, -28.89, -27.8134, -26.7664, -25.7688, -24.8052, -23.8733, -22.9785, -22.1193, -21.2839, -20.4932, -19.7185, -19.0002, -18.2937, -17.6301, -16.9819, -16.3533, -15.7374, -15.1374, -14.5627, -14.0173, -13.5212, -13.0734, -12.6688, -12.2909, -11.9036, -11.4799, -11.0174, -10.5318, -10.0485, -9.5703, -9.10207, -8.65133, -8.2077, -7.79179, -7.38637, -6.99519, -6.61956, -6.24706, -5.87471, -5.50278, -5.13052, -4.76097, -4.40202, -4.0416, -3.70186, -3.35991, -3.05084, -2.75265, -2.47329, -2.21557, -1.97627, -1.75716, -1.54863, -1.36765, -1.20361, -1.06, -0.9368, -0.828902, -0.737888, -0.669784, -0.625862, -0.613157, -0.637569, -0.705282, -0.810496, -0.922923, -0.977326, -0.916568, -0.768283, -0.600545, -0.46013, -0.356256};
  }else{
    G4cerr<<"In: "<<__PRETTY_FUNCTION__<<" at line "<<__LINE__
          <<"\n\tUnknown magnetic field configuration! Quitting!\n";
    exit(1);
  }
}

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......
void MollerGlobalMagnetField::GetFieldValue(const G4double Point[4], G4double *Bfield ) const
{
  Bfield[0]=0;
  Bfield[1]=0;
  Bfield[2]=0;
  if( configuration == "prex1" || configuration == "pvdis" || configuration == "apex" ||
      configuration == "happex2" || configuration == "happex3" || configuration == "prex2_fitFringe" ){
    GetFieldValuePREX2(Point,Bfield);
  }else if( configuration == "crex_fitFringe"){
    GetFieldValueCREX(Point,Bfield);
  }else if( configuration == "prex2JayNoQ1shield" ||
            configuration == "crexJayNoQ1shield"  ||
            configuration == "test" ||
	    configuration == "crex_prevDefault" ||
	    configuration == "crex" ||
	    configuration == "prex2_prevDefault" ||
	    configuration == "prex2"){
    InterpolateFieldValue(Point,Bfield);
  }else if(configuration == "crex_2PipeSeptumShield_allOn" ||
           configuration == "prex2UpdatedSeptumShield_allOn" ||
           configuration == "crexUpdatedSeptumShield_allOn"){
    if( Point[2]-69.91*cm < 91*cm || addQ1fringe )
      InterpolateFieldValue(Point,Bfield);
  }else{
    G4cerr<<"In: "<<__PRETTY_FUNCTION__<<" at line "<<__LINE__
          <<"\n\tUnknown magnetic field configuration! Quitting!\n";
    exit(1);
  }

  if(addQ1fringe && (configuration=="prex2" || configuration=="crex"))
    InterpolateFieldValue(Point,Bfield);
}

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......
void MollerGlobalMagnetField::GetFieldValuePREX2(const G4double Point[4], G4double *Bfield ) const
{
  G4double myLocalPointInMainMagnet[4];

  G4double dBxdy = 0.*gauss/cm;
  G4double dBydx = 0.*gauss/cm;

  // gives integral 7003.4 G @ 1 cm
  G4double a = magScaleFactor*158.*gauss/cm;
  G4double shielded = magScaleFactor*0.78 *gauss/cm;
  // bu and bd define center of gaussian approximations of fringe field along z-axis
  G4double bu = -44*cm;
  G4double bd = 44*cm;
  // c1 is gaussian width inside the shield
  G4double c1 = 4.2*cm;
  // c2 is gaussian width outside the shield
  G4double c2 = 14.15*cm;

  // Worksite for new gaussian - Ricky
  // Calculating the new peaks au and ad
  G4double z_intercept_low = mg_field_low + pow( (2*pow(c1,2)*log(a*exp(-(pow(mg_field_low-bu,2)/(2*pow(c2,2))))/shielded)),0.5);
  G4double z_intercept_high =  mg_field_high - pow( (2*pow(c1,2)*log(a*exp(-(pow(mg_field_high-bd,2)/(2*pow(c2,2))))/shielded)),0.5);

  //---------------------------------------------------------------
  // translation from global Point[4] into local magnet coordinates
  //---------------------------------------------------------------
  myLocalPointInMainMagnet[0] = Point[0];             // x-pos
  myLocalPointInMainMagnet[1] = Point[1];             // y-pos
  myLocalPointInMainMagnet[2] = Point[2]-69.91*cm;    // z-pos
  myLocalPointInMainMagnet[3] = Point[3];             // time

  // Parameterizing the gradient as two gaussians at each end of the septum, defined for different z values
  // within the radius of the beampipe through the septum, r = 4.128 cm.
  if(sqrt(pow(myLocalPointInMainMagnet[0],2)+pow(myLocalPointInMainMagnet[1],2))<4.128*cm){
    if ((myLocalPointInMainMagnet[2]>-100*cm)&&(myLocalPointInMainMagnet[2]<100*cm)){
      if (myLocalPointInMainMagnet[2]<mg_field_low){
        dBxdy = a*(exp(-((pow(myLocalPointInMainMagnet[2]-bu,2))/(2*pow(c2,2)))));
      } else if ((myLocalPointInMainMagnet[2]>=mg_field_low)&&(myLocalPointInMainMagnet[2]<z_intercept_low)){
        dBxdy = a*(exp(-(pow(mg_field_low-bu                         ,2)/(2*pow(c2,2)))))*
          (exp(-(pow(myLocalPointInMainMagnet[2]-mg_field_low,2)/(2*pow(c1,2)))));
      } else if ((myLocalPointInMainMagnet[2]>=z_intercept_low)&&(myLocalPointInMainMagnet[2]<=z_intercept_high)){
        dBxdy = shielded;
      } else if ((myLocalPointInMainMagnet[2]<=mg_field_high)&&(myLocalPointInMainMagnet[2]>z_intercept_high)){
        dBxdy = a*(exp(-(pow(mg_field_high-bd                         ,2)/(2*pow(c2,2)))))*
          (exp(-(pow(myLocalPointInMainMagnet[2]-mg_field_high,2)/(2*pow(c1,2)))));
      } else if ((myLocalPointInMainMagnet[2]>mg_field_high)){
        dBxdy = a*(exp(-((pow(myLocalPointInMainMagnet[2]-bd,2))/(2*pow(c2,2)))));
      } else {
        dBxdy=0;
      }
      dBydx=dBxdy;
      Bfield[0] = -myLocalPointInMainMagnet[1]*dBxdy;
      Bfield[1] = -myLocalPointInMainMagnet[0]*dBydx;
      Bfield[2] = 0.;
    } else {
      Bfield[0] = 0.;
      Bfield[1] = 0.;
      Bfield[2] = 0.;
    }
  } else {
    Bfield[0] = 0.;
    Bfield[1] = 0.;
    Bfield[2] = 0.;
  }
}

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......
void MollerGlobalMagnetField::InterpolateFieldValue(const G4double Point[4], G4double *Bfield ) const
{

  G4double myLocalPointInMainMagnet[4];
  G4double dBydx = 0.*gauss/cm;

  //---------------------------------------------------------------
  // translation from global Point[4] into local magnet coordinates
  //---------------------------------------------------------------
  myLocalPointInMainMagnet[0] = Point[0];             // x-pos
  myLocalPointInMainMagnet[1] = Point[1];             // y-pos
  myLocalPointInMainMagnet[2] = Point[2]-69.91*cm;    // z-pos
  myLocalPointInMainMagnet[3] = Point[3];             // time

  // within the radius of the beampipe through the septum, r = 4.128 cm.
  if(sqrt(pow(myLocalPointInMainMagnet[0],2)+pow(myLocalPointInMainMagnet[1],2))<4.128*cm){
    if(abs(myLocalPointInMainMagnet[2])<200*cm){
      dBydx = interpolate(myLocalPointInMainMagnet[2]/cm)*gauss/cm ;
    }
  }

  if((configuration=="prex2" || configuration=="crex") && addQ1fringe){
    Bfield[0] += -myLocalPointInMainMagnet[1]*dBydx;
    Bfield[1] += -myLocalPointInMainMagnet[0]*dBydx;
  }else{
    Bfield[0] = -myLocalPointInMainMagnet[1]*dBydx;
    Bfield[1] = -myLocalPointInMainMagnet[0]*dBydx;
  }
  Bfield[2] = 0;
}

G4double MollerGlobalMagnetField::interpolate(G4double val) const
{
  if( zPosition.size()==0 ) {
    G4cerr<<"In: "<<__PRETTY_FUNCTION__<<" at line "<<__LINE__<<G4endl;
    G4cerr<<"\tTried to interpolate B field however it was not initialized! Did you set a configuration?\n\tQuitting ... \n";
    exit(1);
  }

  if( val <= zPosition.front() ) return 0;
  else if( val >= zPosition.back() ) return 0;

  int lowIndex  = int(std::lower_bound(zPosition.begin(),zPosition.end(),val) - zPosition.begin() ) - 1;
  int highIndex = lowIndex + 1;

  double lowVal  = bXcomponent[lowIndex];
  double highVal = bXcomponent[highIndex];
  double lowX  = zPosition[lowIndex];
  double highX = zPosition[highIndex];

  double returnVal = ( lowVal + (val - lowX) * (highVal - lowVal) / (highX - lowX) );

  return returnVal;
}

//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......
void MollerGlobalMagnetField::GetFieldValueCREX(const G4double Point[4], G4double *Bfield ) const
{
  G4double myLocalPointInMainMagnet[4];

  G4double dBxdy = 0.*gauss/cm;
  G4double dBydx = 0.*gauss/cm;

  // gives integral 7003.4 G @ 1 cm
  G4double a = magScaleFactor*158.*gauss/cm;
  G4double shielded = .78 *gauss/cm;
  // bu and bd define center of gaussian approximations of fringe field along z-axis
  G4double bu = -69*cm;
  G4double bd = 61*cm;
  // c1 is gaussian width inside the shield
  G4double c1 = 3.40*cm;
  G4double c2 = 6.94*cm;
  // c2 is gaussian width outside the shield
  G4double c_mid = 18.69*cm;

  G4double z_intercept_low = mg_field_low + 11.7*cm;
  G4double z_intercept_high = mg_field_high - 8.5*cm;

  //---------------------------------------------------------------
  // translation from global Point[4] into local magnet coordinates
  //---------------------------------------------------------------
  myLocalPointInMainMagnet[0] = Point[0];             // x-pos
  myLocalPointInMainMagnet[1] = Point[1];             // y-pos
  myLocalPointInMainMagnet[2] = Point[2] - 69.91*cm;  // z-pos
  myLocalPointInMainMagnet[3] = Point[3];             // time

  // Parameterizing the gradient as two gaussians at each end of the septum, defined for different z values
  // within the radius of the beampipe through the septum, r = 4.128 cm.
  if( sqrt(pow(myLocalPointInMainMagnet[0],2)+pow(myLocalPointInMainMagnet[1],2))<4.128*cm){
    if ((myLocalPointInMainMagnet[2]>-100*cm)&&(myLocalPointInMainMagnet[2]<100*cm)){
      if (myLocalPointInMainMagnet[2]<mg_field_low){
        dBxdy = shielded+(0.667)*a*(exp(-((pow(myLocalPointInMainMagnet[2]-bu,2))/(2*pow(c2,2)))));
      } else if ((myLocalPointInMainMagnet[2]>=mg_field_low)&&(myLocalPointInMainMagnet[2]<z_intercept_low)){
        dBxdy = shielded+(0.667)*a*(exp(-(pow(mg_field_low-bu                         ,2)/(2*pow(c2,2)))))*
          (exp(-(pow(myLocalPointInMainMagnet[2]-mg_field_low,2)/(2*pow(c1,2)))));
      } else if ((myLocalPointInMainMagnet[2]>=z_intercept_low)&&(myLocalPointInMainMagnet[2]<=z_intercept_high)){
        dBxdy = shielded+a*(exp(-(pow(myLocalPointInMainMagnet[2],2)/(2*pow(c_mid,2)))));
      } else if ((myLocalPointInMainMagnet[2]<=mg_field_high)&&(myLocalPointInMainMagnet[2]>z_intercept_high)){
        dBxdy = shielded+(1.58)*a*(exp(-(pow(mg_field_high-bd                         ,2)/(2*pow(c2,2)))))*
          (exp(-(pow(myLocalPointInMainMagnet[2]-mg_field_high,2)/(2*pow(c1,2)))));
      } else if ((myLocalPointInMainMagnet[2]>mg_field_high)){
        dBxdy = shielded+(1.58)*a*(exp(-((pow(myLocalPointInMainMagnet[2]-bd,2))/(2*pow(c2,2)))));
      } else {
        dBxdy=0;
      }
      dBydx=dBxdy;
      Bfield[0] = -myLocalPointInMainMagnet[1]*dBxdy;
      Bfield[1] = -myLocalPointInMainMagnet[0]*dBydx;
      Bfield[2] = 0.;
    } else {
      Bfield[0] = 0.;
      Bfield[1] = 0.;
      Bfield[2] = 0.;
    }
  } else {
    Bfield[0] = 0.;
    Bfield[1] = 0.;
    Bfield[2] = 0.;
  }
}


//....oooOO0OOooo........oooOO0OOooo........oooOO0OOooo........oooOO0OOooo......
void MollerGlobalMagnetField::WriteMagField()
{
  G4cout << G4endl
         << "###### Printing Septum field on file ######"
         << G4endl << G4endl;
  G4cout << G4endl
         << "Magnetic Shielding low limit= " << mg_field_low
         << "   Magnetic Shielding high limit= " << mg_field_high << G4endl;

  double z[201];
  double grB[201][3];
  double grB2[201][3];
  double gr_dBxdy[201];
  G4double g4grB[201][3];
  G4double point[4];
  point[0] = 1.*cm;
  point[1] = 0.*cm;
  point[3] = 0.*ns;
  G4double point2[4];
  double gr_dy = 0.001*cm;
  point2[0] = 1.*cm;
  point2[1] = gr_dy;
  point2[3] = 0.*ns;
  for (int i=0; i<201; i++) {
    z[i] = 175.211-105.3+double(i-100);
    point[2] = z[i] *cm;
    point2[2] = z[i] *cm;
    GetFieldValue(point,g4grB[i]);
    for (int j=0; j<3; j++) grB[i][j]=(double)g4grB[i][j]/gauss;
    GetFieldValue(point2,g4grB[i]);
    for (int j=0; j<3; j++) grB2[i][j]=(double)g4grB[i][j]/gauss;
    gr_dBxdy[i] = (grB2[i][0]- grB[i][0])/(gr_dy/cm);
    G4cout << z[i] << " " << point[2]/cm << " " << gr_dBxdy[i] << G4endl;
  }
  TGraph * graph_Mag_field = new TGraph(201,z,gr_dBxdy);
  graph_Mag_field->SetTitle("Magnetic Field #frac{dBx}{dy} at (-1cm,0cm,z);z(cm);gauss/cm");
  graph_Mag_field->Write();
}
